"use strict";
const collection = require("../functions/models/collection");
const wishlist = require("../functions/models/wishlist");
const collectionManager = require("../functions/dataManager/collectionManager");
const collectionErrorHandler = require("../functions/error/collectionErrorHandler");
const gameObject = require("../functions/models/game");
const gameDAO = require("../functions/dataManager/gameManager");
const priceDataManager = require("../functions/dataManager/priceChartingDataManager");
const gamePriceData = require("../functions/models/gamePriceData");
const Interfaces = require("../functions/shared/interfaces/interfaces");
const gamePriceDAO = require("../functions/dataManager/gamePriceDataManager");
const gameCommon = require("../functions/shared/common/game");
test("Add Game to Wishlist", async () => {
    let inputData = {
        collectionID: '2',
        gameName: 'Super Mario',
        yearReleased: 1992,
        genre: 'Action-Adventure',
        console: 'Nintendo 64',
        developer: 'Nintendo'
    };
    let userData = {
        userID: 'erikchaulk',
        email: 'erikchaulk@gmail.com'
    };
    let gameID = '987654';
    let itemType = '[CollectionItem]#[Wishlist]#[GameItem]';
    let testGame = new gameObject.Game(gameID, userData.userID, userData.email, inputData.gameName, itemType, inputData.collectionID, inputData.yearReleased, inputData.genre, inputData.console, inputData.developer);
    let testWishlist = new wishlist.Wishlist(userData.userID, inputData.collectionID);
    let response = await collectionManager.addGameToCollection(testGame, testWishlist);
    expect(response).toEqual([testGame]);
});
test("Add Game to Wishlist that already exists", async () => {
    let inputData = {
        collectionID: '2',
        gameName: 'Super Mario',
        yearReleased: 1992,
        genre: 'Action-Adventure',
        console: 'Nintendo 64',
        developer: 'Nintendo'
    };
    let userData = {
        userID: 'erikchaulk',
        email: 'erikchaulk@gmail.com'
    };
    let gameID = '987654';
    let itemType = '[CollectionItem]#[Wishlist]#[GameItem]';
    let testGame = new gameObject.Game(gameID, userData.userID, userData.email, inputData.gameName, itemType, inputData.collectionID, inputData.yearReleased, inputData.genre, inputData.console, inputData.developer);
    let testWishlist = new wishlist.Wishlist(userData.userID, inputData.collectionID);
    await expect(collectionManager.addGameToCollection(testGame, testWishlist))
        .rejects
        .toThrow("Game error, datastore response: Unable to create game.  Conditional Check Failed.");
});
test("removeGameFromCollection", async () => {
    let inputData = {
        collectionID: '2',
        gameName: 'Super Mario',
        yearReleased: 1992,
        genre: 'Action-Adventure',
        console: 'Nintendo 64',
        developer: 'Nintendo'
    };
    let inputDataForSecondGame = {
        collectionID: '2',
        gameName: 'Overwatch',
        yearReleased: 2016,
        genre: 'First-Person Shooter',
        console: 'PC',
        developer: 'Blizzard'
    };
    let userData = {
        userID: 'erikchaulk',
        email: 'erikchaulk@gmail.com'
    };
    let gameID = '987654';
    let secondGameID = '667788';
    let itemType = '[CollectionItem]#[Wishlist]#[GameItem]';
    let testGame = new gameObject.Game(gameID, userData.userID, userData.email, inputData.gameName, itemType, inputData.collectionID, inputData.yearReleased, inputData.genre, inputData.console, inputData.developer);
    let secondTestGame = new gameObject.Game(secondGameID, userData.userID, userData.email, inputDataForSecondGame.gameName, itemType, inputDataForSecondGame.collectionID, inputDataForSecondGame.yearReleased, inputDataForSecondGame.genre, inputDataForSecondGame.console, inputDataForSecondGame.developer);
    let testWishlist = new wishlist.Wishlist(userData.userID, inputDataForSecondGame.collectionID);
    await collectionManager.addGameToCollection(secondTestGame, testWishlist);
    let response = await collectionManager.removeGameFromCollection(secondTestGame, testWishlist);
    expect(response).toEqual([testGame]);
});
test("Remove a game that does not exist in a collection (i.e. attempt to remove a game that was already removed)", async () => {
    let inputDataForSecondGame = {
        collectionID: '2',
        gameName: 'Overwatch',
        yearReleased: 2016,
        genre: 'First-Person Shooter',
        console: 'PC',
        developer: 'Blizzard'
    };
    let userData = {
        userID: 'erikchaulk',
        email: 'erikchaulk@gmail.com'
    };
    let secondGameID = '667788';
    let itemType = '[CollectionItem]#[Wishlist]#[GameItem]';
    let secondTestGame = new gameObject.Game(secondGameID, userData.userID, userData.email, inputDataForSecondGame.gameName, itemType, inputDataForSecondGame.collectionID, inputDataForSecondGame.yearReleased, inputDataForSecondGame.genre, inputDataForSecondGame.console, inputDataForSecondGame.developer);
    let testWishlist = new wishlist.Wishlist(userData.userID, inputDataForSecondGame.collectionID);
    await expect(collectionManager.removeGameFromCollection(secondTestGame, testWishlist))
        .rejects
        .toThrow("Game error, datastore response: Unable to delete game.  Conditional Check Failed.");
});
test("modifyGameInCollection", async () => {
    let inputData = {
        collectionID: '2',
        gameName: 'Super Mario',
        yearReleased: 1993,
        genre: 'Action-Adventure',
        console: 'Nintendo 64',
        developer: 'Nintendo'
    };
    let userData = {
        userID: 'erikchaulk',
        email: 'erikchaulk@gmail.com'
    };
    let gameID = '987654';
    let itemType = '[CollectionItem]#[Wishlist]#[GameItem]';
    let testGame = new gameObject.Game(gameID, userData.userID, userData.email, inputData.gameName, itemType, inputData.collectionID, inputData.yearReleased, inputData.genre, inputData.console, inputData.developer);
    let testWishlist = new wishlist.Wishlist(userData.userID, inputData.collectionID);
    let response = await collectionManager.modifyGameInCollection(testGame, testWishlist);
    expect(response).toEqual([testGame]);
});
test("Modify a game that does not exist in the collection.", async () => {
    let inputData = {
        collectionID: '2',
        gameName: 'Super Smash Brothers',
        yearReleased: 1993,
        genre: 'Fighting',
        console: 'Nintendo 64',
        developer: 'Nintendo'
    };
    let userData = {
        userID: 'erikchaulk',
        email: 'erikchaulk@gmail.com'
    };
    let gameID = '331122';
    let itemType = '[CollectionItem]#[Wishlist]#[GameItem]';
    let testGame = new gameObject.Game(gameID, userData.userID, userData.email, inputData.gameName, itemType, inputData.collectionID, inputData.yearReleased, inputData.genre, inputData.console, inputData.developer);
    let testWishlist = new wishlist.Wishlist(userData.userID, inputData.collectionID);
    await expect(collectionManager.modifyGameInCollection(testGame, testWishlist))
        .rejects
        .toThrow("Game error, datastore response: Unable to modify game.  Conditional Check Failed.");
});
test("getGameInCollection", async () => {
    let inputData = {
        collectionID: '2',
        gameName: 'Super Mario',
        yearReleased: 1993,
        genre: 'Action-Adventure',
        console: 'Nintendo 64',
        developer: 'Nintendo'
    };
    let userData = {
        userID: 'erikchaulk',
        email: 'erikchaulk@gmail.com'
    };
    let gameID = '987654';
    let itemType = '[CollectionItem]#[Wishlist]#[GameItem]';
    let testGame = new gameObject.Game(gameID, userData.userID, userData.email, inputData.gameName, itemType, inputData.collectionID, inputData.yearReleased, inputData.genre, inputData.console, inputData.developer);
    let testWishlist = new wishlist.Wishlist(userData.userID, inputData.collectionID);
    let response = await collectionManager.getGameInCollection(testGame, testWishlist);
    expect(response).toEqual(testGame);
});
test("Attempt to get a game that doesn't exist in the collection", async () => {
    let inputData = {
        collectionID: '1',
        gameName: 'Super Mario',
        yearReleased: 1993,
        genre: 'Action-Adventure',
        console: 'Nintendo 64',
        developer: 'Nintendo'
    };
    let userData = {
        userID: 'erikchaulk',
        email: 'erikchaulk@gmail.com'
    };
    //The game ID is the only different attribute, which causes it to not be found and throw an error.
    let gameID = '009988';
    let itemType = '[CollectionItem]#[Wishlist]#[GameItem]';
    let testGame = new gameObject.Game(gameID, userData.userID, userData.email, inputData.gameName, itemType, inputData.collectionID, inputData.yearReleased, inputData.genre, inputData.console, inputData.developer);
    let testWishlist = new wishlist.Wishlist(userData.userID, inputData.collectionID);
    await expect(collectionManager.getGameInCollection(testGame, testWishlist))
        .rejects
        .toThrow("Game error, datastore response: Unable to get game. Game not found.");
});
test("collectionError", async () => {
    let collectionError = new collectionErrorHandler.CollectionError("Game not found in the collection.");
    expect(collectionError.message).toEqual('Collection error, datastore response: Game not found in the collection.');
});
test("getAllGamesInCollection", async () => {
    let inputData = {
        collectionID: '2',
        gameName: 'Super Mario',
        yearReleased: 1993,
        genre: 'Action-Adventure',
        console: 'Nintendo 64',
        developer: 'Nintendo'
    };
    let userData = {
        userID: 'erikchaulk',
        email: 'erikchaulk@gmail.com'
    };
    let gameID = '987654';
    let itemType = '[CollectionItem]#[Wishlist]#[GameItem]';
    let testGame = new gameObject.Game(gameID, userData.userID, userData.email, inputData.gameName, itemType, inputData.collectionID, inputData.yearReleased, inputData.genre, inputData.console, inputData.developer);
    let testWishlist = new wishlist.Wishlist(userData.userID, inputData.collectionID);
    let response = await collectionManager.getAllGamesInCollection(testWishlist);
    expect(response).toEqual([testGame]);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZnVuY3Rpb25zLmNvbGxlY3Rpb24udGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImZ1bmN0aW9ucy5jb2xsZWN0aW9uLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE1BQU0sVUFBVSxHQUFHLE9BQU8sQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDO0FBQzdELE1BQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyw4QkFBOEIsQ0FBQyxDQUFDO0FBQ3pELE1BQU0saUJBQWlCLEdBQUcsT0FBTyxDQUFDLDRDQUE0QyxDQUFDLENBQUM7QUFDaEYsTUFBTSxzQkFBc0IsR0FBRyxPQUFPLENBQUMsMkNBQTJDLENBQUMsQ0FBQztBQUNwRixNQUFNLFVBQVUsR0FBRyxPQUFPLENBQUMsMEJBQTBCLENBQUMsQ0FBQztBQUN2RCxNQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsc0NBQXNDLENBQUMsQ0FBQztBQUNoRSxNQUFNLGdCQUFnQixHQUFHLE9BQU8sQ0FBQyxtREFBbUQsQ0FBQyxDQUFDO0FBQ3RGLE1BQU0sYUFBYSxHQUFHLE9BQU8sQ0FBQyxtQ0FBbUMsQ0FBQyxDQUFDO0FBQ25FLE1BQU0sVUFBVSxHQUFHLE9BQU8sQ0FBQywyQ0FBMkMsQ0FBQyxDQUFDO0FBQ3hFLE1BQU0sWUFBWSxHQUFHLE9BQU8sQ0FBQywrQ0FBK0MsQ0FBQyxDQUFDO0FBQzlFLE1BQU0sVUFBVSxHQUFHLE9BQU8sQ0FBQyxpQ0FBaUMsQ0FBQyxDQUFDO0FBRTlELElBQUksQ0FBQyxzQkFBc0IsRUFBRSxLQUFLLElBQUksRUFBRTtJQUNwQyxJQUFJLFNBQVMsR0FBRztRQUNaLFlBQVksRUFBRSxHQUFHO1FBQ2pCLFFBQVEsRUFBRSxhQUFhO1FBQ3ZCLFlBQVksRUFBRSxJQUFJO1FBQ2xCLEtBQUssRUFBRSxrQkFBa0I7UUFDekIsT0FBTyxFQUFFLGFBQWE7UUFDdEIsU0FBUyxFQUFFLFVBQVU7S0FDeEIsQ0FBQTtJQUNELElBQUksUUFBUSxHQUFHO1FBQ1gsTUFBTSxF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c0JBQXNCO0tBQ2hDLENBQUM7SUFDRixJQUFJLE1BQU0sR0FBRyxRQUFRLENBQUE7SUFDckIsSUFBSSxRQUFRLEdBQUcsd0NBQXdDLENBQUM7SUFDeEQsSUFBSSxRQUFRLEdBQUcsSUFBSSxVQUFVLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDLFFBQVEsRUFBRSxRQUFRLEVBQUUsU0FBUyxDQUFDLFlBQVksRUFBRSxTQUFTLENBQUMsWUFBWSxFQUFFLFNBQVMsQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDLE9BQU8sRUFBRSxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDbk4sSUFBSSxZQUFZLEdBQUcsSUFBSSxRQUFRLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsU0FBUyxDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQ2xGLElBQUksUUFBUSxHQUFHLE1BQU0saUJBQWlCLENBQUMsdUJBQXVCLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDN0UsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7QUFDekMsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBjb2xsZWN0aW9uID0gcmVxdWlyZShcIi4uL2Z1bmN0aW9ucy9tb2RlbHMvY29sbGVjdGlvblwiKTtcclxuY29uc3Qgd2lzaGxpc3QgPSByZXF1aXJlKFwiLi4vZnVuY3Rpb25zL21vZGVscy93aXNobGlzdFwiKTtcclxuY29uc3QgY29sbGVjdGlvbk1hbmFnZXIgPSByZXF1aXJlKFwiLi4vZnVuY3Rpb25zL2RhdGFNYW5hZ2VyL2NvbGxlY3Rpb25NYW5hZ2VyXCIpO1xyXG5jb25zdCBjb2xsZWN0aW9uRXJyb3JIYW5kbGVyID0gcmVxdWlyZShcIi4uL2Z1bmN0aW9ucy9lcnJvci9jb2xsZWN0aW9uRXJyb3JIYW5kbGVyXCIpO1xyXG5jb25zdCBnYW1lT2JqZWN0ID0gcmVxdWlyZShcIi4uL2Z1bmN0aW9ucy9tb2RlbHMvZ2FtZVwiKTtcclxuY29uc3QgZ2FtZURBTyA9IHJlcXVpcmUoXCIuLi9mdW5jdGlvbnMvZGF0YU1hbmFnZXIvZ2FtZU1hbmFnZXJcIik7XHJcbmNvbnN0IHByaWNlRGF0YU1hbmFnZXIgPSByZXF1aXJlKFwiLi4vZnVuY3Rpb25zL2RhdGFNYW5hZ2VyL3ByaWNlQ2hhcnRpbmdEYXRhTWFuYWdlclwiKTtcclxuY29uc3QgZ2FtZVByaWNlRGF0YSA9IHJlcXVpcmUoXCIuLi9mdW5jdGlvbnMvbW9kZWxzL2dhbWVQcmljZURhdGFcIik7XHJcbmNvbnN0IEludGVyZmFjZXMgPSByZXF1aXJlKFwiLi4vZnVuY3Rpb25zL3NoYXJlZC9pbnRlcmZhY2VzL2ludGVyZmFjZXNcIik7XHJcbmNvbnN0IGdhbWVQcmljZURBTyA9IHJlcXVpcmUoXCIuLi9mdW5jdGlvbnMvZGF0YU1hbmFnZXIvZ2FtZVByaWNlRGF0YU1hbmFnZXJcIik7XHJcbmNvbnN0IGdhbWVDb21tb24gPSByZXF1aXJlKFwiLi4vZnVuY3Rpb25zL3NoYXJlZC9jb21tb24vZ2FtZVwiKTtcclxuXHJcbnRlc3QoXCJBZGQgR2FtZSB0byBXaXNobGlzdFwiLCBhc3luYyAoKSA9PiB7XHJcbiAgICBsZXQgaW5wdXREYXRhID0ge1xyXG4gICAgICAgIGNvbGxlY3Rpb25JRDogJzInLFxyXG4gICAgICAgIGdhbWVOYW1lOiAnU3VwZXIgTWFyaW8nLFxyXG4gICAgICAgIHllYXJSZWxlYXNlZDogMTk5MixcclxuICAgICAgICBnZW5yZTogJ0FjdGlvbi1BZHZlbnR1cmUnLFxyXG4gICAgICAgIGNvbnNvbGU6ICdOaW50ZW5kbyA2NCcsXHJcbiAgICAgICAgZGV2ZWxvcGVyOiAnTmludGVuZG8nXHJcbiAgICB9XHJcbiAgICBsZXQgdXNlckRhdGEgPSB7XHJcbiAgICAgICAgdXNlcklEOiAnZXJpa2NoYXVsaycsXHJcbiAgICAgICAgZW1haWw6ICdlcmlrY2hhdWxrQGdtYWlsLmNvbSdcclxuICAgIH07XHJcbiAgICBsZXQgZ2FtZUlEID0gJzk4NzY1NCdcclxuICAgIGxldCBpdGVtVHlwZSA9ICdbQ29sbGVjdGlvbkl0ZW1dI1tXaXNobGlzdF0jW0dhbWVJdGVtXSc7XHJcbiAgICBsZXQgdGVzdEdhbWUgPSBuZXcgZ2FtZU9iamVjdC5HYW1lKGdhbWVJRCwgdXNlckRhdGEudXNlcklELCB1c2VyRGF0YS5lbWFpbCwgaW5wdXREYXRhLmdhbWVOYW1lLCBpdGVtVHlwZSwgaW5wdXREYXRhLmNvbGxlY3Rpb25JRCwgaW5wdXREYXRhLnllYXJSZWxlYXNlZCwgaW5wdXREYXRhLmdlbnJlLCBpbnB1dERhdGEuY29uc29sZSwgaW5wdXREYXRhLmRldmVsb3Blcik7XHJcbiAgICBsZXQgdGVzdFdpc2hsaXN0ID0gbmV3IHdpc2hsaXN0Lldpc2hsaXN0KHVzZXJEYXRhLnVzZXJJRCwgaW5wdXREYXRhLmNvbGxlY3Rpb25JRCk7XHJcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBjb2xsZWN0aW9uTWFuYWdlci5hZGRHYW1lVG9Db2xsZWN0aW9uKHRlc3RHYW1lLCB0ZXN0V2lzaGxpc3QpO1xyXG4gICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKFt0ZXN0R2FtZV0pO1xyXG59KTtcclxuXHJcbnRlc3QoXCJBZGQgR2FtZSB0byBXaXNobGlzdCB0aGF0IGFscmVhZHkgZXhpc3RzXCIsIGFzeW5jICgpID0+IHtcclxuICAgIGxldCBpbnB1dERhdGEgPSB7XHJcbiAgICAgICAgY29sbGVjdGlvbklEOiAnMicsXHJcbiAgICAgICAgZ2FtZU5hbWU6ICdTdXBlciBNYXJpbycsXHJcbiAgICAgICAgeWVhclJlbGVhc2VkOiAxOTkyLFxyXG4gICAgICAgIGdlbnJlOiAnQWN0aW9uLUFkdmVudHVyZScsXHJcbiAgICAgICAgY29uc29sZTogJ05pbnRlbmRvIDY0JyxcclxuICAgICAgICBkZXZlbG9wZXI6ICdOaW50ZW5kbydcclxuICAgIH1cclxuICAgIGxldCB1c2VyRGF0YSA9IHtcclxuICAgICAgICB1c2VySUQ6ICdlcmlrY2hhdWxrJyxcclxuICAgICAgICBlbWFpbDogJ2VyaWtjaGF1bGtAZ21haWwuY29tJ1xyXG4gICAgfTtcclxuICAgIGxldCBnYW1lSUQgPSAnOTg3NjU0J1xyXG4gICAgbGV0IGl0ZW1UeXBlID0gJ1tDb2xsZWN0aW9uSXRlbV0jW1dpc2hsaXN0XSNbR2FtZUl0ZW1dJztcclxuICAgIGxldCB0ZXN0R2FtZSA9IG5ldyBnYW1lT2JqZWN0LkdhbWUoZ2FtZUlELCB1c2VyRGF0YS51c2VySUQsIHVzZXJEYXRhLmVtYWlsLCBpbnB1dERhdGEuZ2FtZU5hbWUsIGl0ZW1UeXBlLCBpbnB1dERhdGEuY29sbGVjdGlvbklELCBpbnB1dERhdGEueWVhclJlbGVhc2VkLCBpbnB1dERhdGEuZ2VucmUsIGlucHV0RGF0YS5jb25zb2xlLCBpbnB1dERhdGEuZGV2ZWxvcGVyKTtcclxuICAgIGxldCB0ZXN0V2lzaGxpc3QgPSBuZXcgd2lzaGxpc3QuV2lzaGxpc3QodXNlckRhdGEudXNlcklELCBpbnB1dERhdGEuY29sbGVjdGlvbklEKTtcclxuICAgIGF3YWl0IGV4cGVjdChjb2xsZWN0aW9uTWFuYWdlci5hZGRHYW1lVG9Db2xsZWN0aW9uKHRlc3RHYW1lLCB0ZXN0V2lzaGxpc3QpKVxyXG4gICAgLnJlamVjdHNcclxuICAgIC50b1Rocm93KFwiR2FtZSBlcnJvciwgZGF0YXN0b3JlIHJlc3BvbnNlOiBVbmFibGUgdG8gY3JlYXRlIGdhbWUuICBDb25kaXRpb25hbCBDaGVjayBGYWlsZWQuXCIpXHJcbn0pO1xyXG5cclxudGVzdChcInJlbW92ZUdhbWVGcm9tQ29sbGVjdGlvblwiLCBhc3luYyAoKSA9PiB7XHJcbiAgICBsZXQgaW5wdXREYXRhID0ge1xyXG4gICAgICAgIGNvbGxlY3Rpb25JRDogJzInLFxyXG4gICAgICAgIGdhbWVOYW1lOiAnU3VwZXIgTWFyaW8nLFxyXG4gICAgICAgIHllYXJSZWxlYXNlZDogMTk5MixcclxuICAgICAgICBnZW5yZTogJ0FjdGlvbi1BZHZlbnR1cmUnLFxyXG4gICAgICAgIGNvbnNvbGU6ICdOaW50ZW5kbyA2NCcsXHJcbiAgICAgICAgZGV2ZWxvcGVyOiAnTmludGVuZG8nXHJcbiAgICB9XHJcbiAgICBsZXQgaW5wdXREYXRhRm9yU2Vjb25kR2FtZSA9IHtcclxuICAgICAgICBjb2xsZWN0aW9uSUQ6ICcyJyxcclxuICAgICAgICBnYW1lTmFtZTogJ092ZXJ3YXRjaCcsXHJcbiAgICAgICAgeWVhclJlbGVhc2VkOiAyMDE2LFxyXG4gICAgICAgIGdlbnJlOiAnRmlyc3QtUGVyc29uIFNob290ZXInLFxyXG4gICAgICAgIGNvbnNvbGU6ICdQQycsXHJcbiAgICAgICAgZGV2ZWxvcGVyOiAnQmxpenphcmQnXHJcbiAgICB9XHJcbiAgICBsZXQgdXNlckRhdGEgPSB7XHJcbiAgICAgICAgdXNlcklEOiAnZXJpa2NoYXVsaycsXHJcbiAgICAgICAgZW1haWw6ICdlcmlrY2hhdWxrQGdtYWlsLmNvbSdcclxuICAgIH07XHJcbiAgICBsZXQgZ2FtZUlEID0gJzk4NzY1NCc7XHJcbiAgICBsZXQgc2Vjb25kR2FtZUlEID0gJzY2Nzc4OCc7XHJcbiAgICBsZXQgaXRlbVR5cGUgPSAnW0NvbGxlY3Rpb25JdGVtXSNbV2lzaGxpc3RdI1tHYW1lSXRlbV0nO1xyXG4gICAgbGV0IHRlc3RHYW1lID0gbmV3IGdhbWVPYmplY3QuR2FtZShnYW1lSUQsIHVzZXJEYXRhLnVzZXJJRCwgdXNlckRhdGEuZW1haWwsIGlucHV0RGF0YS5nYW1lTmFtZSwgaXRlbVR5cGUsIGlucHV0RGF0YS5jb2xsZWN0aW9uSUQsIGlucHV0RGF0YS55ZWFyUmVsZWFzZWQsIGlucHV0RGF0YS5nZW5yZSwgaW5wdXREYXRhLmNvbnNvbGUsIGlucHV0RGF0YS5kZXZlbG9wZXIpO1xyXG4gICAgbGV0IHNlY29uZFRlc3RHYW1lID0gbmV3IGdhbWVPYmplY3QuR2FtZShzZWNvbmRHYW1lSUQsIHVzZXJEYXRhLnVzZXJJRCwgdXNlckRhdGEuZW1haWwsIGlucHV0RGF0YUZvclNlY29uZEdhbWUuZ2FtZU5hbWUsIGl0ZW1UeXBlLCBpbnB1dERhdGFGb3JTZWNvbmRHYW1lLmNvbGxlY3Rpb25JRCwgaW5wdXREYXRhRm9yU2Vjb25kR2FtZS55ZWFyUmVsZWFzZWQsIGlucHV0RGF0YUZvclNlY29uZEdhbWUuZ2VucmUsIGlucHV0RGF0YUZvclNlY29uZEdhbWUuY29uc29sZSwgaW5wdXREYXRhRm9yU2Vjb25kR2FtZS5kZXZlbG9wZXIpO1xyXG4gICAgbGV0IHRlc3RXaXNobGlzdCA9IG5ldyB3aXNobGlzdC5XaXNobGlzdCh1c2VyRGF0YS51c2VySUQsIGlucHV0RGF0YUZvclNlY29uZEdhbWUuY29sbGVjdGlvbklEKTtcclxuICAgIGF3YWl0IGNvbGxlY3Rpb25NYW5hZ2VyLmFkZEdhbWVUb0NvbGxlY3Rpb24oc2Vjb25kVGVzdEdhbWUsIHRlc3RXaXNobGlzdCk7XHJcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBjb2xsZWN0aW9uTWFuYWdlci5yZW1vdmVHYW1lRnJvbUNvbGxlY3Rpb24oc2Vjb25kVGVzdEdhbWUsIHRlc3RXaXNobGlzdCk7XHJcbiAgICBleHBlY3QocmVzcG9uc2UpLnRvRXF1YWwoW3Rlc3RHYW1lXSk7XHJcbn0pO1xyXG5cclxudGVzdChcIlJlbW92ZSBhIGdhbWUgdGhhdCBkb2VzIG5vdCBleGlzdCBpbiBhIGNvbGxlY3Rpb24gKGkuZS4gYXR0ZW1wdCB0byByZW1vdmUgYSBnYW1lIHRoYXQgd2FzIGFscmVhZHkgcmVtb3ZlZClcIiwgYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IGlucHV0RGF0YUZvclNlY29uZEdhbWUgPSB7XHJcbiAgICAgICAgY29sbGVjdGlvbklEOiAnMicsXHJcbiAgICAgICAgZ2FtZU5hbWU6ICdPdmVyd2F0Y2gnLFxyXG4gICAgICAgIHllYXJSZWxlYXNlZDogMjAxNixcclxuICAgICAgICBnZW5yZTogJ0ZpcnN0LVBlcnNvbiBTaG9vdGVyJyxcclxuICAgICAgICBjb25zb2xlOiAnUEMnLFxyXG4gICAgICAgIGRldmVsb3BlcjogJ0JsaXp6YXJkJ1xyXG4gICAgfVxyXG4gICAgbGV0IHVzZXJEYXRhID0ge1xyXG4gICAgICAgIHVzZXJJRDogJ2VyaWtjaGF1bGsnLFxyXG4gICAgICAgIGVtYWlsOiAnZXJpa2NoYXVsa0BnbWFpbC5jb20nXHJcbiAgICB9O1xyXG4gICAgbGV0IHNlY29uZEdhbWVJRCA9ICc2Njc3ODgnO1xyXG4gICAgbGV0IGl0ZW1UeXBlID0gJ1tDb2xsZWN0aW9uSXRlbV0jW1dpc2hsaXN0XSNbR2FtZUl0ZW1dJztcclxuICAgIGxldCBzZWNvbmRUZXN0R2FtZSA9IG5ldyBnYW1lT2JqZWN0LkdhbWUoc2Vjb25kR2FtZUlELCB1c2VyRGF0YS51c2VySUQsIHVzZXJEYXRhLmVtYWlsLCBpbnB1dERhdGFGb3JTZWNvbmRHYW1lLmdhbWVOYW1lLCBpdGVtVHlwZSwgaW5wdXREYXRhRm9yU2Vjb25kR2FtZS5jb2xsZWN0aW9uSUQsIGlucHV0RGF0YUZvclNlY29uZEdhbWUueWVhclJlbGVhc2VkLCBpbnB1dERhdGFGb3JTZWNvbmRHYW1lLmdlbnJlLCBpbnB1dERhdGFGb3JTZWNvbmRHYW1lLmNvbnNvbGUsIGlucHV0RGF0YUZvclNlY29uZEdhbWUuZGV2ZWxvcGVyKTtcclxuICAgIGxldCB0ZXN0V2lzaGxpc3QgPSBuZXcgd2lzaGxpc3QuV2lzaGxpc3QodXNlckRhdGEudXNlcklELCBpbnB1dERhdGFGb3JTZWNvbmRHYW1lLmNvbGxlY3Rpb25JRCk7XHJcbiAgICBhd2FpdCBleHBlY3QoY29sbGVjdGlvbk1hbmFnZXIucmVtb3ZlR2FtZUZyb21Db2xsZWN0aW9uKHNlY29uZFRlc3RHYW1lLCB0ZXN0V2lzaGxpc3QpKVxyXG4gICAgLnJlamVjdHNcclxuICAgIC50b1Rocm93KFwiR2FtZSBlcnJvciwgZGF0YXN0b3JlIHJlc3BvbnNlOiBVbmFibGUgdG8gZGVsZXRlIGdhbWUuICBDb25kaXRpb25hbCBDaGVjayBGYWlsZWQuXCIpXHJcbn0pO1xyXG5cclxudGVzdChcIm1vZGlmeUdhbWVJbkNvbGxlY3Rpb25cIiwgYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IGlucHV0RGF0YSA9IHtcclxuICAgICAgICBjb2xsZWN0aW9uSUQ6ICcyJyxcclxuICAgICAgICBnYW1lTmFtZTogJ1N1cGVyIE1hcmlvJyxcclxuICAgICAgICB5ZWFyUmVsZWFzZWQ6IDE5OTMsXHJcbiAgICAgICAgZ2VucmU6ICdBY3Rpb24tQWR2ZW50dXJlJyxcclxuICAgICAgICBjb25zb2xlOiAnTmludGVuZG8gNjQnLFxyXG4gICAgICAgIGRldmVsb3BlcjogJ05pbnRlbmRvJ1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBsZXQgdXNlckRhdGEgPSB7XHJcbiAgICAgICAgdXNlcklEOiAnZXJpa2NoYXVsaycsXHJcbiAgICAgICAgZW1haWw6ICdlcmlrY2hhdWxrQGdtYWlsLmNvbSdcclxuICAgIH07XHJcbiAgICBsZXQgZ2FtZUlEID0gJzk4NzY1NCdcclxuICAgIGxldCBpdGVtVHlwZSA9ICdbQ29sbGVjdGlvbkl0ZW1dI1tXaXNobGlzdF0jW0dhbWVJdGVtXSc7XHJcbiAgICBsZXQgdGVzdEdhbWUgPSBuZXcgZ2FtZU9iamVjdC5HYW1lKGdhbWVJRCwgdXNlckRhdGEudXNlcklELCB1c2VyRGF0YS5lbWFpbCwgaW5wdXREYXRhLmdhbWVOYW1lLCBpdGVtVHlwZSwgaW5wdXREYXRhLmNvbGxlY3Rpb25JRCwgaW5wdXREYXRhLnllYXJSZWxlYXNlZCwgaW5wdXREYXRhLmdlbnJlLCBpbnB1dERhdGEuY29uc29sZSwgaW5wdXREYXRhLmRldmVsb3Blcik7XHJcbiAgICBsZXQgdGVzdFdpc2hsaXN0ID0gbmV3IHdpc2hsaXN0Lldpc2hsaXN0KHVzZXJEYXRhLnVzZXJJRCwgaW5wdXREYXRhLmNvbGxlY3Rpb25JRCk7XHJcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBjb2xsZWN0aW9uTWFuYWdlci5tb2RpZnlHYW1lSW5Db2xsZWN0aW9uKHRlc3RHYW1lLCB0ZXN0V2lzaGxpc3QpO1xyXG4gICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKFt0ZXN0R2FtZV0pO1xyXG59KTtcclxuXHJcbnRlc3QoXCJNb2RpZnkgYSBnYW1lIHRoYXQgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGNvbGxlY3Rpb24uXCIsIGFzeW5jICgpID0+IHtcclxuICAgIGxldCBpbnB1dERhdGEgPSB7XHJcbiAgICAgICAgY29sbGVjdGlvbklEOiAnMicsXHJcbiAgICAgICAgZ2FtZU5hbWU6ICdTdXBlciBTbWFzaCBCcm90aGVycycsXHJcbiAgICAgICAgeWVhclJlbGVhc2VkOiAxOTkzLFxyXG4gICAgICAgIGdlbnJlOiAnRmlnaHRpbmcnLFxyXG4gICAgICAgIGNvbnNvbGU6ICdOaW50ZW5kbyA2NCcsXHJcbiAgICAgICAgZGV2ZWxvcGVyOiAnTmludGVuZG8nXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGxldCB1c2VyRGF0YSA9IHtcclxuICAgICAgICB1c2VySUQ6ICdlcmlrY2hhdWxrJyxcclxuICAgICAgICBlbWFpbDogJ2VyaWtjaGF1bGtAZ21haWwuY29tJ1xyXG4gICAgfTtcclxuICAgIGxldCBnYW1lSUQgPSAnMzMxMTIyJ1xyXG4gICAgbGV0IGl0ZW1UeXBlID0gJ1tDb2xsZWN0aW9uSXRlbV0jW1dpc2hsaXN0XSNbR2FtZUl0ZW1dJztcclxuICAgIGxldCB0ZXN0R2FtZSA9IG5ldyBnYW1lT2JqZWN0LkdhbWUoZ2FtZUlELCB1c2VyRGF0YS51c2VySUQsIHVzZXJEYXRhLmVtYWlsLCBpbnB1dERhdGEuZ2FtZU5hbWUsIGl0ZW1UeXBlLCBpbnB1dERhdGEuY29sbGVjdGlvbklELCBpbnB1dERhdGEueWVhclJlbGVhc2VkLCBpbnB1dERhdGEuZ2VucmUsIGlucHV0RGF0YS5jb25zb2xlLCBpbnB1dERhdGEuZGV2ZWxvcGVyKTtcclxuICAgIGxldCB0ZXN0V2lzaGxpc3QgPSBuZXcgd2lzaGxpc3QuV2lzaGxpc3QodXNlckRhdGEudXNlcklELCBpbnB1dERhdGEuY29sbGVjdGlvbklEKTtcclxuICAgIGF3YWl0IGV4cGVjdChjb2xsZWN0aW9uTWFuYWdlci5tb2RpZnlHYW1lSW5Db2xsZWN0aW9uKHRlc3RHYW1lLCB0ZXN0V2lzaGxpc3QpKVxyXG4gICAgLnJlamVjdHNcclxuICAgIC50b1Rocm93KFwiR2FtZSBlcnJvciwgZGF0YXN0b3JlIHJlc3BvbnNlOiBVbmFibGUgdG8gbW9kaWZ5IGdhbWUuICBDb25kaXRpb25hbCBDaGVjayBGYWlsZWQuXCIpXHJcbn0pO1xyXG5cclxudGVzdChcImdldEdhbWVJbkNvbGxlY3Rpb25cIiwgYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IGlucHV0RGF0YSA9IHtcclxuICAgICAgICBjb2xsZWN0aW9uSUQ6ICcyJyxcclxuICAgICAgICBnYW1lTmFtZTogJ1N1cGVyIE1hcmlvJyxcclxuICAgICAgICB5ZWFyUmVsZWFzZWQ6IDE5OTMsXHJcbiAgICAgICAgZ2VucmU6ICdBY3Rpb24tQWR2ZW50dXJlJyxcclxuICAgICAgICBjb25zb2xlOiAnTmludGVuZG8gNjQnLFxyXG4gICAgICAgIGRldmVsb3BlcjogJ05pbnRlbmRvJ1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBsZXQgdXNlckRhdGEgPSB7XHJcbiAgICAgICAgdXNlcklEOiAnZXJpa2NoYXVsaycsXHJcbiAgICAgICAgZW1haWw6ICdlcmlrY2hhdWxrQGdtYWlsLmNvbSdcclxuICAgIH07XHJcbiAgICBsZXQgZ2FtZUlEID0gJzk4NzY1NCdcclxuICAgIGxldCBpdGVtVHlwZSA9ICdbQ29sbGVjdGlvbkl0ZW1dI1tXaXNobGlzdF0jW0dhbWVJdGVtXSc7XHJcbiAgICBsZXQgdGVzdEdhbWUgPSBuZXcgZ2FtZU9iamVjdC5HYW1lKGdhbWVJRCwgdXNlckRhdGEudXNlcklELCB1c2VyRGF0YS5lbWFpbCwgaW5wdXREYXRhLmdhbWVOYW1lLCBpdGVtVHlwZSwgaW5wdXREYXRhLmNvbGxlY3Rpb25JRCwgaW5wdXREYXRhLnllYXJSZWxlYXNlZCwgaW5wdXREYXRhLmdlbnJlLCBpbnB1dERhdGEuY29uc29sZSwgaW5wdXREYXRhLmRldmVsb3Blcik7XHJcbiAgICBsZXQgdGVzdFdpc2hsaXN0ID0gbmV3IHdpc2hsaXN0Lldpc2hsaXN0KHVzZXJEYXRhLnVzZXJJRCwgaW5wdXREYXRhLmNvbGxlY3Rpb25JRCk7XHJcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBjb2xsZWN0aW9uTWFuYWdlci5nZXRHYW1lSW5Db2xsZWN0aW9uKHRlc3RHYW1lLCB0ZXN0V2lzaGxpc3QpO1xyXG4gICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKHRlc3RHYW1lKTtcclxufSk7XHJcblxyXG50ZXN0KFwiQXR0ZW1wdCB0byBnZXQgYSBnYW1lIHRoYXQgZG9lc24ndCBleGlzdCBpbiB0aGUgY29sbGVjdGlvblwiLCBhc3luYyAoKSA9PiB7XHJcbiAgICBsZXQgaW5wdXREYXRhID0ge1xyXG4gICAgICAgIGNvbGxlY3Rpb25JRDogJzEnLFxyXG4gICAgICAgIGdhbWVOYW1lOiAnU3VwZXIgTWFyaW8nLFxyXG4gICAgICAgIHllYXJSZWxlYXNlZDogMTk5MyxcclxuICAgICAgICBnZW5yZTogJ0FjdGlvbi1BZHZlbnR1cmUnLFxyXG4gICAgICAgIGNvbnNvbGU6ICdOaW50ZW5kbyA2NCcsXHJcbiAgICAgICAgZGV2ZWxvcGVyOiAnTmludGVuZG8nXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGxldCB1c2VyRGF0YSA9IHtcclxuICAgICAgICB1c2VySUQ6ICdlcmlrY2hhdWxrJyxcclxuICAgICAgICBlbWFpbDogJ2VyaWtjaGF1bGtAZ21haWwuY29tJ1xyXG4gICAgfTtcclxuICAgIC8vVGhlIGdhbWUgSUQgaXMgdGhlIG9ubHkgZGlmZmVyZW50IGF0dHJpYnV0ZSwgd2hpY2ggY2F1c2VzIGl0IHRvIG5vdCBiZSBmb3VuZCBhbmQgdGhyb3cgYW4gZXJyb3IuXHJcbiAgICBsZXQgZ2FtZUlEID0gJzAwOTk4OCdcclxuICAgIGxldCBpdGVtVHlwZSA9ICdbQ29sbGVjdGlvbkl0ZW1dI1tXaXNobGlzdF0jW0dhbWVJdGVtXSc7XHJcbiAgICBsZXQgdGVzdEdhbWUgPSBuZXcgZ2FtZU9iamVjdC5HYW1lKGdhbWVJRCwgdXNlckRhdGEudXNlcklELCB1c2VyRGF0YS5lbWFpbCwgaW5wdXREYXRhLmdhbWVOYW1lLCBpdGVtVHlwZSwgaW5wdXREYXRhLmNvbGxlY3Rpb25JRCwgaW5wdXREYXRhLnllYXJSZWxlYXNlZCwgaW5wdXREYXRhLmdlbnJlLCBpbnB1dERhdGEuY29uc29sZSwgaW5wdXREYXRhLmRldmVsb3Blcik7XHJcbiAgICBsZXQgdGVzdFdpc2hsaXN0ID0gbmV3IHdpc2hsaXN0Lldpc2hsaXN0KHVzZXJEYXRhLnVzZXJJRCwgaW5wdXREYXRhLmNvbGxlY3Rpb25JRCk7XHJcbiAgICBhd2FpdCBleHBlY3QoY29sbGVjdGlvbk1hbmFnZXIuZ2V0R2FtZUluQ29sbGVjdGlvbih0ZXN0R2FtZSwgdGVzdFdpc2hsaXN0KSlcclxuICAgIC5yZWplY3RzXHJcbiAgICAudG9UaHJvdyhcIkdhbWUgZXJyb3IsIGRhdGFzdG9yZSByZXNwb25zZTogVW5hYmxlIHRvIGdldCBnYW1lLiBHYW1lIG5vdCBmb3VuZC5cIilcclxufSk7XHJcblxyXG50ZXN0KFwiY29sbGVjdGlvbkVycm9yXCIsIGFzeW5jICgpID0+IHtcclxuICAgIGxldCBjb2xsZWN0aW9uRXJyb3IgPSBuZXcgY29sbGVjdGlvbkVycm9ySGFuZGxlci5Db2xsZWN0aW9uRXJyb3IoXCJHYW1lIG5vdCBmb3VuZCBpbiB0aGUgY29sbGVjdGlvbi5cIik7XHJcbiAgICBleHBlY3QoY29sbGVjdGlvbkVycm9yLm1lc3NhZ2UpLnRvRXF1YWwoJ0NvbGxlY3Rpb24gZXJyb3IsIGRhdGFzdG9yZSByZXNwb25zZTogR2FtZSBub3QgZm91bmQgaW4gdGhlIGNvbGxlY3Rpb24uJyk7XHJcbn0pO1xyXG5cclxudGVzdChcImdldEFsbEdhbWVzSW5Db2xsZWN0aW9uXCIsIGFzeW5jICgpID0+IHtcclxuICAgIGxldCBpbnB1dERhdGEgPSB7XHJcbiAgICAgICAgY29sbGVjdGlvbklEOiAnMicsXHJcbiAgICAgICAgZ2FtZU5hbWU6ICdTdXBlciBNYXJpbycsXHJcbiAgICAgICAgeWVhclJlbGVhc2VkOiAxOTkzLFxyXG4gICAgICAgIGdlbnJlOiAnQWN0aW9uLUFkdmVudHVyZScsXHJcbiAgICAgICAgY29uc29sZTogJ05pbnRlbmRvIDY0JyxcclxuICAgICAgICBkZXZlbG9wZXI6ICdOaW50ZW5kbydcclxuICAgIH1cclxuICAgIFxyXG4gICAgbGV0IHVzZXJEYXRhID0ge1xyXG4gICAgICAgIHVzZXJJRDogJ2VyaWtjaGF1bGsnLFxyXG4gICAgICAgIGVtYWlsOiAnZXJpa2NoYXVsa0BnbWFpbC5jb20nXHJcbiAgICB9O1xyXG4gICAgbGV0IGdhbWVJRCA9ICc5ODc2NTQnXHJcbiAgICBsZXQgaXRlbVR5cGUgPSAnW0NvbGxlY3Rpb25JdGVtXSNbV2lzaGxpc3RdI1tHYW1lSXRlbV0nO1xyXG4gICAgbGV0IHRlc3RHYW1lID0gbmV3IGdhbWVPYmplY3QuR2FtZShnYW1lSUQsIHVzZXJEYXRhLnVzZXJJRCwgdXNlckRhdGEuZW1haWwsIGlucHV0RGF0YS5nYW1lTmFtZSwgaXRlbVR5cGUsIGlucHV0RGF0YS5jb2xsZWN0aW9uSUQsIGlucHV0RGF0YS55ZWFyUmVsZWFzZWQsIGlucHV0RGF0YS5nZW5yZSwgaW5wdXREYXRhLmNvbnNvbGUsIGlucHV0RGF0YS5kZXZlbG9wZXIpO1xyXG4gICAgbGV0IHRlc3RXaXNobGlzdCA9IG5ldyB3aXNobGlzdC5XaXNobGlzdCh1c2VyRGF0YS51c2VySUQsIGlucHV0RGF0YS5jb2xsZWN0aW9uSUQpO1xyXG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgY29sbGVjdGlvbk1hbmFnZXIuZ2V0QWxsR2FtZXNJbkNvbGxlY3Rpb24odGVzdFdpc2hsaXN0KTtcclxuICAgIGV4cGVjdChyZXNwb25zZSkudG9FcXVhbChbdGVzdEdhbWVdKTtcclxufSk7Il19