"use strict";
const game = require("../functions/models/game");
const gameManager = require("../functions/dataManager/gameManager");
const httpResponse = require("../functions/shared/common/httpResponse");
const error = require("../functions/error/gameErrorHandler");
const common = require("../functions/shared/common/game");
test("CreateGame", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testCreateGame = new game.Game(gameID, userID, 'League of Legends', 2008, 'Moba', 'PC', 'Riot Games');
    let response = await gameManager.createGame(testCreateGame);
    expect(response).toEqual(testCreateGame);
});
test("GetGame", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGetGame = new game.Game(gameID, userID, 'League of Legends', 2008, 'Moba', 'PC', 'Riot Games');
    let response = await gameManager.getGame(testGetGame);
    expect(response).toEqual(testGetGame);
});
test("ModifyGame", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testModifyGame = new game.Game(gameID, userID, 'League of Legends', 2010, 'Moba', 'PC', 'Riot Games');
    let response = await gameManager.modifyGame(testModifyGame);
    expect(response).toEqual(testModifyGame);
});
test("DeleteGame", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testDeleteGame = new game.Game(gameID, userID, 'League of Legends', 2010, 'Moba', 'PC', 'Riot Games');
    let response = await gameManager.deleteGame(testDeleteGame);
    expect(response).toEqual(testDeleteGame);
});
test("serializeExistingGameData", async () => {
    let data = {
        'gameID': '123456',
        'gameName': 'League of Legends',
        'yearReleased': 2010,
        'genre': 'Moba',
        'console': 'PC',
        'developer': 'Riot Games'
    };
    let userData = {
        userID: 'erikchaulk',
    };
    let response = common.serializeExistingGameData(userData, data);
    let testDynamoResponse = new game.Game(data.gameID, userData.userID, 'League of Legends', 2010, 'Moba', 'PC', 'Riot Games');
    expect(response).toEqual(testDynamoResponse);
});
test("gameErrorHandler", async () => {
    let testError = new error.GameError('Game not found');
    expect(testError.message).toEqual("Game error, datastore response: Game not found");
});
test("createGameHttpResponse", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'League of Legends', 2010, 'Moba', 'PC', 'Riot Games');
    let response = await httpResponse.createGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 200, body: JSON.stringify(testGame) }));
});
//Game already created
test("createGameHttpResponse", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'League of Legends', 2010, 'Moba', 'PC', 'Riot Games');
    let response = await httpResponse.createGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 400, body: "Game Error" }));
});
test("getGameHttpResponse", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'League of Legends', 2010, 'Moba', 'PC', 'Riot Games');
    let response = await httpResponse.getGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 200, body: JSON.stringify(testGame) }));
});
test("modifyGameHttpResponse", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'League of Legends', 2012, 'Moba', 'PC', 'Riot Games');
    let response = await httpResponse.modifyGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 200, body: JSON.stringify(testGame) }));
});
//Modify a game that doesn't exist
test("modifyGameHttpResponse", async () => {
    let gameID = '234567';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'The Witness', 2016, 'Strategy', 'PC', 'Valve');
    let response = await httpResponse.modifyGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 400, body: "Game Error" }));
});
test("deleteGameHttpResponse", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'League of Legends', 2012, 'Moba', 'PC', 'Riot Games');
    let response = await httpResponse.deleteGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 200, body: JSON.stringify(testGame) }));
});
//Delete a game that doesn't exist
test("deleteGameHttpResponse", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'League of Legends', 2012, 'Moba', 'PC', 'Riot Games');
    let response = await httpResponse.deleteGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 400, body: "Game Error" }));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZnVuY3Rpb25zLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJmdW5jdGlvbnMudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLDBCQUEwQixDQUFDLENBQUM7QUFDakQsTUFBTSxXQUFXLEdBQUcsT0FBTyxDQUFDLHNDQUFzQyxDQUFDLENBQUM7QUFDcEUsTUFBTSxZQUFZLEdBQUcsT0FBTyxDQUFDLHlDQUF5QyxDQUFDLENBQUM7QUFDeEUsTUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLHFDQUFxQyxDQUFDLENBQUE7QUFDNUQsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLGlDQUFpQyxDQUFDLENBQUM7QUFFMUQsSUFBSSxDQUFDLFlBQVksRUFBRSxLQUFLLElBQUksRUFBRTtJQUMxQixJQUFJLE1BQU0sR0FBRyxRQUFRLENBQUM7SUFDdEIsSUFBSSxNQUFNLEdBQUcsWUFBWSxDQUFDO0lBQzFCLElBQUksY0FBYyxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLG1CQUFtQixFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQzFHLElBQUksUUFBUSxHQUFHLE1BQU0sV0FBVyxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUM1RCxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBQzdDLENBQUMsQ0FBQyxDQUFDO0FBRUgsSUFBSSxDQUFDLFNBQVMsRUFBRSxLQUFLLElBQUksRUFBRTtJQUN2QixJQUFJLE1BQU0sR0FBRyxRQUFRLENBQUM7SUFDdEIsSUFBSSxNQUFNLEdBQUcsWUFBWSxDQUFDO0lBQzFCLElBQUksV0FBVyxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLG1CQUFtQixFQUFFLElBQUks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QUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxtQkFBbUIsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxZQUFZLENBQUMsQ0FBQztJQUNwRyxJQUFJLFFBQVEsR0FBRyxNQUFNLFlBQVksQ0FBQyxzQkFBc0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNuRSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxZQUFZLENBQUMsRUFBQyxVQUFVLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxZQUFZLEVBQUMsQ0FBQyxDQUFDLENBQUM7QUFDL0YsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBnYW1lID0gcmVxdWlyZShcIi4uL2Z1bmN0aW9ucy9tb2RlbHMvZ2FtZVwiKTtcbmNvbnN0IGdhbWVNYW5hZ2VyID0gcmVxdWlyZShcIi4uL2Z1bmN0aW9ucy9kYXRhTWFuYWdlci9nYW1lTWFuYWdlclwiKTtcbmNvbnN0IGh0dHBSZXNwb25zZSA9IHJlcXVpcmUoXCIuLi9mdW5jdGlvbnMvc2hhcmVkL2NvbW1vbi9odHRwUmVzcG9uc2VcIik7XG5jb25zdCBlcnJvciA9IHJlcXVpcmUoXCIuLi9mdW5jdGlvbnMvZXJyb3IvZ2FtZUVycm9ySGFuZGxlclwiKVxuY29uc3QgY29tbW9uID0gcmVxdWlyZShcIi4uL2Z1bmN0aW9ucy9zaGFyZWQvY29tbW9uL2dhbWVcIik7XG5cbnRlc3QoXCJDcmVhdGVHYW1lXCIsIGFzeW5jICgpID0+IHtcbiAgICBsZXQgZ2FtZUlEID0gJzEyMzQ1Nic7XG4gICAgbGV0IHVzZXJJRCA9ICdlcmlrY2hhdWxrJztcbiAgICBsZXQgdGVzdENyZWF0ZUdhbWUgPSBuZXcgZ2FtZS5HYW1lKGdhbWVJRCwgdXNlcklELCAnTGVhZ3VlIG9mIExlZ2VuZHMnLCAyMDA4LCAnTW9iYScsICdQQycsICdSaW90IEdhbWVzJyk7XG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgZ2FtZU1hbmFnZXIuY3JlYXRlR2FtZSh0ZXN0Q3JlYXRlR2FtZSk7XG4gICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKHRlc3RDcmVhdGVHYW1lKTtcbn0pO1xuXG50ZXN0KFwiR2V0R2FtZVwiLCBhc3luYyAoKSA9PiB7XG4gICAgbGV0IGdhbWVJRCA9ICcxMjM0NTYnO1xuICAgIGxldCB1c2VySUQgPSAnZXJpa2NoYXVsayc7XG4gICAgbGV0IHRlc3RHZXRHYW1lID0gbmV3IGdhbWUuR2FtZShnYW1lSUQsIHVzZXJJRCwgJ0xlYWd1ZSBvZiBMZWdlbmRzJywgMjAwOCwgJ01vYmEnLCAnUEMnLCAnUmlvdCBHYW1lcycpO1xuICAgIGxldCByZXNwb25zZSA9IGF3YWl0IGdhbWVNYW5hZ2VyLmdldEdhbWUodGVzdEdldEdhbWUpO1xuICAgIGV4cGVjdChyZXNwb25zZSkudG9FcXVhbCh0ZXN0R2V0R2FtZSk7XG59KTtcblxudGVzdChcIk1vZGlmeUdhbWVcIiwgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBnYW1lSUQgPSAnMTIzNDU2JztcbiAgICBsZXQgdXNlcklEID0gJ2VyaWtjaGF1bGsnO1xuICAgIGxldCB0ZXN0TW9kaWZ5R2FtZSA9IG5ldyBnYW1lLkdhbWUoZ2FtZUlELCB1c2VySUQsICdMZWFndWUgb2YgTGVnZW5kcycsIDIwMTAsICdNb2JhJywgJ1BDJywgJ1Jpb3QgR2FtZXMnKTtcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBnYW1lTWFuYWdlci5tb2RpZnlHYW1lKHRlc3RNb2RpZnlHYW1lKTtcbiAgICBleHBlY3QocmVzcG9uc2UpLnRvRXF1YWwodGVzdE1vZGlmeUdhbWUpO1xufSk7XG5cbnRlc3QoXCJEZWxldGVHYW1lXCIsIGFzeW5jICgpID0+IHtcbiAgICBsZXQgZ2FtZUlEID0gJzEyMzQ1Nic7XG4gICAgbGV0IHVzZXJJRCA9ICdlcmlrY2hhdWxrJztcbiAgICBsZXQgdGVzdERlbGV0ZUdhbWUgPSBuZXcgZ2FtZS5HYW1lKGdhbWVJRCwgdXNlcklELCAnTGVhZ3VlIG9mIExlZ2VuZHMnLCAyMDEwLCAnTW9iYScsICdQQycsICdSaW90IEdhbWVzJyk7XG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgZ2FtZU1hbmFnZXIuZGVsZXRlR2FtZSh0ZXN0RGVsZXRlR2FtZSk7XG4gICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKHRlc3REZWxldGVHYW1lKTtcbn0pO1xuXG50ZXN0KFwic2VyaWFsaXplRXhpc3RpbmdHYW1lRGF0YVwiLCBhc3luYyAoKSA9PiB7XG4gICAgbGV0IGRhdGEgPSB7XG4gICAgICAgICdnYW1lSUQnOicxMjM0NTYnLFxuICAgICAgICAnZ2FtZU5hbWUnOidMZWFndWUgb2YgTGVnZW5kcycsXG4gICAgICAgICd5ZWFyUmVsZWFzZWQnOjIwMTAsXG4gICAgICAgICdnZW5yZSc6J01vYmEnLFxuICAgICAgICAnY29uc29sZSc6J1BDJyxcbiAgICAgICAgJ2RldmVsb3Blcic6J1Jpb3QgR2FtZXMnXG4gICAgfSBcbiAgICBsZXQgdXNlckRhdGEgPSB7XG4gICAgICAgIHVzZXJJRDogJ2VyaWtjaGF1bGsnLFxuICAgIH1cbiAgICBsZXQgcmVzcG9uc2UgPSBjb21tb24uc2VyaWFsaXplRXhpc3RpbmdHYW1lRGF0YSh1c2VyRGF0YSwgZGF0YSk7XG4gICAgbGV0IHRlc3REeW5hbW9SZXNwb25zZSA9IG5ldyBnYW1lLkdhbWUoZGF0YS5nYW1lSUQsIHVzZXJEYXRhLnVzZXJJRCwgJ0xlYWd1ZSBvZiBMZWdlbmRzJywgMjAxMCwgJ01vYmEnLCAnUEMnLCAnUmlvdCBHYW1lcycpO1xuICAgIGV4cGVjdChyZXNwb25zZSkudG9FcXVhbCh0ZXN0RHluYW1vUmVzcG9uc2UpO1xufSk7XG5cbnRlc3QoXCJnYW1lRXJyb3JIYW5kbGVyXCIsIGFzeW5jICgpID0+IHtcbiAgICBsZXQgdGVzdEVycm9yID0gbmV3IGVycm9yLkdhbWVFcnJvcignR2FtZSBub3QgZm91bmQnKTtcbiAgICBleHBlY3QodGVzdEVycm9yLm1lc3NhZ2UpLnRvRXF1YWwoXCJHYW1lIGVycm9yLCBkYXRhc3RvcmUgcmVzcG9uc2U6IEdhbWUgbm90IGZvdW5kXCIpO1xufSk7XG5cbnRlc3QoXCJjcmVhdGVHYW1lSHR0cFJlc3BvbnNlXCIsIGFzeW5jICgpID0+IHtcbiAgICBsZXQgZ2FtZUlEID0gJzEyMzQ1Nic7XG4gICAgbGV0IHVzZXJJRCA9ICdlcmlrY2hhdWxrJztcbiAgICBsZXQgdGVzdEdhbWUgPSBuZXcgZ2FtZS5HYW1lKGdhbWVJRCwgdXNlcklELCAnTGVhZ3VlIG9mIExlZ2VuZHMnLCAyMDEwLCAnTW9iYScsICdQQycsICdSaW90IEdhbWVzJyk7XG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgaHR0cFJlc3BvbnNlLmNyZWF0ZUdhbWVIdHRwUmVzcG9uc2UodGVzdEdhbWUpO1xuICAgIGV4cGVjdChyZXNwb25zZSkudG9FcXVhbChodHRwUmVzcG9uc2UuaHR0cFJlc3BvbnNlKHtzdGF0dXNDb2RlOiAyMDAsIGJvZHk6IEpTT04uc3RyaW5naWZ5KHRlc3RHYW1lKX0pKTtcbn0pO1xuXG4vL0dhbWUgYWxyZWFkeSBjcmVhdGVkXG50ZXN0KFwiY3JlYXRlR2FtZUh0dHBSZXNwb25zZVwiLCBhc3luYyAoKSA9PiB7XG4gICAgbGV0IGdhbWVJRCA9ICcxMjM0NTYnO1xuICAgIGxldCB1c2VySUQgPSAnZXJpa2NoYXVsayc7XG4gICAgbGV0IHRlc3RHYW1lID0gbmV3IGdhbWUuR2FtZShnYW1lSUQsIHVzZXJJRCwgJ0xlYWd1ZSBvZiBMZWdlbmRzJywgMjAxMCwgJ01vYmEnLCAnUEMnLCAnUmlvdCBHYW1lcycpO1xuICAgIGxldCByZXNwb25zZSA9IGF3YWl0IGh0dHBSZXNwb25zZS5jcmVhdGVHYW1lSHR0cFJlc3BvbnNlKHRlc3RHYW1lKTtcbiAgICBleHBlY3QocmVzcG9uc2UpLnRvRXF1YWwoaHR0cFJlc3BvbnNlLmh0dHBSZXNwb25zZSh7c3RhdHVzQ29kZTogNDAwLCBib2R5OiBcIkdhbWUgRXJyb3JcIn0pKTtcbn0pO1xuXG50ZXN0KFwiZ2V0R2FtZUh0dHBSZXNwb25zZVwiLCBhc3luYyAoKSA9PiB7XG4gICAgbGV0IGdhbWVJRCA9ICcxMjM0NTYnO1xuICAgIGxldCB1c2VySUQgPSAnZXJpa2NoYXVsayc7XG4gICAgbGV0IHRlc3RHYW1lID0gbmV3IGdhbWUuR2FtZShnYW1lSUQsIHVzZXJJRCwgJ0xlYWd1ZSBvZiBMZWdlbmRzJywgMjAxMCwgJ01vYmEnLCAnUEMnLCAnUmlvdCBHYW1lcycpO1xuICAgIGxldCByZXNwb25zZSA9IGF3YWl0IGh0dHBSZXNwb25zZS5nZXRHYW1lSHR0cFJlc3BvbnNlKHRlc3RHYW1lKTtcbiAgICBleHBlY3QocmVzcG9uc2UpLnRvRXF1YWwoaHR0cFJlc3BvbnNlLmh0dHBSZXNwb25zZSh7c3RhdHVzQ29kZTogMjAwLCBib2R5OiBKU09OLnN0cmluZ2lmeSh0ZXN0R2FtZSl9KSk7XG59KTtcblxudGVzdChcIm1vZGlmeUdhbWVIdHRwUmVzcG9uc2VcIiwgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBnYW1lSUQgPSAnMTIzNDU2JztcbiAgICBsZXQgdXNlcklEID0gJ2VyaWtjaGF1bGsnO1xuICAgIGxldCB0ZXN0R2FtZSA9IG5ldyBnYW1lLkdhbWUoZ2FtZUlELCB1c2VySUQsICdMZWFndWUgb2YgTGVnZW5kcycsIDIwMTIsICdNb2JhJywgJ1BDJywgJ1Jpb3QgR2FtZXMnKTtcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBodHRwUmVzcG9uc2UubW9kaWZ5R2FtZUh0dHBSZXNwb25zZSh0ZXN0R2FtZSk7XG4gICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKGh0dHBSZXNwb25zZS5odHRwUmVzcG9uc2Uoe3N0YXR1c0NvZGU6IDIwMCwgYm9keTogSlNPTi5zdHJpbmdpZnkodGVzdEdhbWUpfSkpO1xufSk7XG5cbi8vTW9kaWZ5IGEgZ2FtZSB0aGF0IGRvZXNuJ3QgZXhpc3RcbnRlc3QoXCJtb2RpZnlHYW1lSHR0cFJlc3BvbnNlXCIsIGFzeW5jICgpID0+IHtcbiAgICBsZXQgZ2FtZUlEID0gJzIzNDU2Nyc7XG4gICAgbGV0IHVzZXJJRCA9ICdlcmlrY2hhdWxrJztcbiAgICBsZXQgdGVzdEdhbWUgPSBuZXcgZ2FtZS5HYW1lKGdhbWVJRCwgdXNlcklELCAnVGhlIFdpdG5lc3MnLCAyMDE2LCAnU3RyYXRlZ3knLCAnUEMnLCAnVmFsdmUnKTtcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBodHRwUmVzcG9uc2UubW9kaWZ5R2FtZUh0dHBSZXNwb25zZSh0ZXN0R2FtZSk7XG4gICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKGh0dHBSZXNwb25zZS5odHRwUmVzcG9uc2Uoe3N0YXR1c0NvZGU6IDQwMCwgYm9keTogXCJHYW1lIEVycm9yXCJ9KSk7XG59KTtcblxudGVzdChcImRlbGV0ZUdhbWVIdHRwUmVzcG9uc2VcIiwgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBnYW1lSUQgPSAnMTIzNDU2JztcbiAgICBsZXQgdXNlcklEID0gJ2VyaWtjaGF1bGsnO1xuICAgIGxldCB0ZXN0R2FtZSA9IG5ldyBnYW1lLkdhbWUoZ2FtZUlELCB1c2VySUQsICdMZWFndWUgb2YgTGVnZW5kcycsIDIwMTIsICdNb2JhJywgJ1BDJywgJ1Jpb3QgR2FtZXMnKTtcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBodHRwUmVzcG9uc2UuZGVsZXRlR2FtZUh0dHBSZXNwb25zZSh0ZXN0R2FtZSk7XG4gICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKGh0dHBSZXNwb25zZS5odHRwUmVzcG9uc2Uoe3N0YXR1c0NvZGU6IDIwMCwgYm9keTogSlNPTi5zdHJpbmdpZnkodGVzdEdhbWUpfSkpO1xufSk7XG5cbi8vRGVsZXRlIGEgZ2FtZSB0aGF0IGRvZXNuJ3QgZXhpc3RcbnRlc3QoXCJkZWxldGVHYW1lSHR0cFJlc3BvbnNlXCIsIGFzeW5jICgpID0+IHtcbiAgICBsZXQgZ2FtZUlEID0gJzEyMzQ1Nic7XG4gICAgbGV0IHVzZXJJRCA9ICdlcmlrY2hhdWxrJztcbiAgICBsZXQgdGVzdEdhbWUgPSBuZXcgZ2FtZS5HYW1lKGdhbWVJRCwgdXNlcklELCAnTGVhZ3VlIG9mIExlZ2VuZHMnLCAyMDEyLCAnTW9iYScsICdQQycsICdSaW90IEdhbWVzJyk7XG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgaHR0cFJlc3BvbnNlLmRlbGV0ZUdhbWVIdHRwUmVzcG9uc2UodGVzdEdhbWUpO1xuICAgIGV4cGVjdChyZXNwb25zZSkudG9FcXVhbChodHRwUmVzcG9uc2UuaHR0cFJlc3BvbnNlKHtzdGF0dXNDb2RlOiA0MDAsIGJvZHk6IFwiR2FtZSBFcnJvclwifSkpO1xufSk7Il19