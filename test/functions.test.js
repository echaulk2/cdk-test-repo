"use strict";
const game = require("../functions/models/game");
const gameManager = require("../functions/dataManager/gameManager");
const httpResponse = require("../functions/shared/common/httpResponse");
const error = require("../functions/error/gameErrorHandler");
const common = require("../functions/shared/common/game");
test("CreateGame", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testCreateGame = new game.Game(gameID, userID, 'League of Legends', 2008, 'Moba', 'PC', 'Riot Games');
    let response = await gameManager.createGame(testCreateGame);
    expect(response).toEqual(testCreateGame);
});
test("GetGame", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGetGame = new game.Game(gameID, userID, 'League of Legends', 2008, 'Moba', 'PC', 'Riot Games');
    let response = await gameManager.getGame(testGetGame);
    expect(response).toEqual(testGetGame);
});
test("ModifyGame", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testModifyGame = new game.Game(gameID, userID, 'League of Legends', 2010, 'Moba', 'PC', 'Riot Games');
    let response = await gameManager.modifyGame(testModifyGame);
    expect(response).toEqual(testModifyGame);
});
test("DeleteGame", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testDeleteGame = new game.Game(gameID, userID, 'League of Legends', 2010, 'Moba', 'PC', 'Riot Games');
    let response = await gameManager.deleteGame(testDeleteGame);
    expect(response).toEqual(testDeleteGame);
});
test("serializeExistingGameData", async () => {
    let data = {
        'gameID': '123456',
        'gameName': 'League of Legends',
        'yearReleased': 2010,
        'genre': 'Moba',
        'console': 'PC',
        'developer': 'Riot Games'
    };
    let userData = {
        userID: 'erikchaulk',
    };
    let response = common.serializeExistingGameData(userData, data);
    let testDynamoResponse = new game.Game(data.gameID, userData.userID, 'League of Legends', 2010, 'Moba', 'PC', 'Riot Games');
    expect(response).toEqual(testDynamoResponse);
});
test("gameErrorHandler", async () => {
    let testError = new error.GameError('Game not found');
    expect(testError.message).toEqual("Game error, datastore response: Game not found");
});
test("createGameHttpResponse", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'League of Legends', 2010, 'Moba', 'PC', 'Riot Games');
    let response = await httpResponse.createGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 200, body: JSON.stringify(testGame) }));
});
//Game already created
test("createGameHttpResponse", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'League of Legends', 2010, 'Moba', 'PC', 'Riot Games');
    let response = await httpResponse.createGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 400, body: "Game Error" }));
});
test("getGameHttpResponse", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'League of Legends', 2010, 'Moba', 'PC', 'Riot Games');
    let response = await httpResponse.getGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 200, body: JSON.stringify(testGame) }));
});
test("modifyGameHttpResponse", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'League of Legends', 2012, 'Moba', 'PC', 'Riot Games');
    let response = await httpResponse.modifyGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 200, body: JSON.stringify(testGame) }));
});
//Modify a game that doesn't exist
test("modifyGameHttpResponse", async () => {
    let gameID = '234567';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'The Witness', 2016, 'Strategy', 'PC', 'Valve');
    let response = await httpResponse.modifyGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 400, body: "Game Error" }));
});
test("deleteGameHttpResponse", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'League of Legends', 2012, 'Moba', 'PC', 'Riot Games');
    let response = await httpResponse.deleteGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 200, body: JSON.stringify(testGame) }));
});
//Delete a game that doesn't exist
test("deleteGameHttpResponse", async () => {
    let gameID = '123456';
    let userID = 'erikchaulk';
    let testGame = new game.Game(gameID, userID, 'League of Legends', 2012, 'Moba', 'PC', 'Riot Games');
    let response = await httpResponse.deleteGameHttpResponse(testGame);
    expect(response).toEqual(httpResponse.httpResponse({ statusCode: 400, body: "Game Error" }));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZnVuY3Rpb25zLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJmdW5jdGlvbnMudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLDBCQUEwQixDQUFDLENBQUM7QUFDakQsTUFBTSxXQUFXLEdBQUcsT0FBTyxDQUFDLHNDQUFzQyxDQUFDLENBQUM7QUFDcEUsTUFBTSxZQUFZLEdBQUcsT0FBTyxDQUFDLHlDQUF5QyxDQUFDLENBQUM7QUFDeEUsTUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLHFDQUFxQyxDQUFDLENBQUE7QUFDNUQsTUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLGlDQUFpQyxDQUFDLENBQUM7QUFFMUQsSUFBSSxDQUFDLFlBQVksRUFBRSxLQUFLLElBQUksRUFBRTtJQUMxQixJQUFJLE1BQU0sR0FBRyxRQUFRLENBQUM7SUFDdEIsSUFBSSxNQUFNLEdBQUcsWUFBWSxDQUFDO0lBQzFCLElBQUksY0FBYyxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLG1CQUFtQixFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQzFHLElBQUksUUFBUSxHQUFHLE1BQU0sV0FBVyxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUM1RCxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBQzdDLENBQUMsQ0FBQyxDQUFDO0FBRUgsSUFBSSxDQUFDLFNBQVMsRUFBRSxLQUFLLElBQUksRUFBRTtJQUN2QixJQUFJLE1BQU0sR0FBRyxRQUFRLENBQUM7SUFDdEIsSUFBSSxNQUFNLEdBQUcsWUFBWSxDQUFDO0lBQzFCLElBQUksV0FBVyxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLG1CQUFtQixFQUFFLElBQUks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QUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxtQkFBbUIsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxZQUFZLENBQUMsQ0FBQztJQUNwRyxJQUFJLFFBQVEsR0FBRyxNQUFNLFlBQVksQ0FBQyxzQkFBc0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNuRSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxZQUFZLENBQUMsRUFBQyxVQUFVLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxZQUFZLEVBQUMsQ0FBQyxDQUFDLENBQUM7QUFDL0YsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBnYW1lID0gcmVxdWlyZShcIi4uL2Z1bmN0aW9ucy9tb2RlbHMvZ2FtZVwiKTtcclxuY29uc3QgZ2FtZU1hbmFnZXIgPSByZXF1aXJlKFwiLi4vZnVuY3Rpb25zL2RhdGFNYW5hZ2VyL2dhbWVNYW5hZ2VyXCIpO1xyXG5jb25zdCBodHRwUmVzcG9uc2UgPSByZXF1aXJlKFwiLi4vZnVuY3Rpb25zL3NoYXJlZC9jb21tb24vaHR0cFJlc3BvbnNlXCIpO1xyXG5jb25zdCBlcnJvciA9IHJlcXVpcmUoXCIuLi9mdW5jdGlvbnMvZXJyb3IvZ2FtZUVycm9ySGFuZGxlclwiKVxyXG5jb25zdCBjb21tb24gPSByZXF1aXJlKFwiLi4vZnVuY3Rpb25zL3NoYXJlZC9jb21tb24vZ2FtZVwiKTtcclxuXHJcbnRlc3QoXCJDcmVhdGVHYW1lXCIsIGFzeW5jICgpID0+IHtcclxuICAgIGxldCBnYW1lSUQgPSAnMTIzNDU2JztcclxuICAgIGxldCB1c2VySUQgPSAnZXJpa2NoYXVsayc7XHJcbiAgICBsZXQgdGVzdENyZWF0ZUdhbWUgPSBuZXcgZ2FtZS5HYW1lKGdhbWVJRCwgdXNlcklELCAnTGVhZ3VlIG9mIExlZ2VuZHMnLCAyMDA4LCAnTW9iYScsICdQQycsICdSaW90IEdhbWVzJyk7XHJcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBnYW1lTWFuYWdlci5jcmVhdGVHYW1lKHRlc3RDcmVhdGVHYW1lKTtcclxuICAgIGV4cGVjdChyZXNwb25zZSkudG9FcXVhbCh0ZXN0Q3JlYXRlR2FtZSk7XHJcbn0pO1xyXG5cclxudGVzdChcIkdldEdhbWVcIiwgYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IGdhbWVJRCA9ICcxMjM0NTYnO1xyXG4gICAgbGV0IHVzZXJJRCA9ICdlcmlrY2hhdWxrJztcclxuICAgIGxldCB0ZXN0R2V0R2FtZSA9IG5ldyBnYW1lLkdhbWUoZ2FtZUlELCB1c2VySUQsICdMZWFndWUgb2YgTGVnZW5kcycsIDIwMDgsICdNb2JhJywgJ1BDJywgJ1Jpb3QgR2FtZXMnKTtcclxuICAgIGxldCByZXNwb25zZSA9IGF3YWl0IGdhbWVNYW5hZ2VyLmdldEdhbWUodGVzdEdldEdhbWUpO1xyXG4gICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKHRlc3RHZXRHYW1lKTtcclxufSk7XHJcblxyXG50ZXN0KFwiTW9kaWZ5R2FtZVwiLCBhc3luYyAoKSA9PiB7XHJcbiAgICBsZXQgZ2FtZUlEID0gJzEyMzQ1Nic7XHJcbiAgICBsZXQgdXNlcklEID0gJ2VyaWtjaGF1bGsnO1xyXG4gICAgbGV0IHRlc3RNb2RpZnlHYW1lID0gbmV3IGdhbWUuR2FtZShnYW1lSUQsIHVzZXJJRCwgJ0xlYWd1ZSBvZiBMZWdlbmRzJywgMjAxMCwgJ01vYmEnLCAnUEMnLCAnUmlvdCBHYW1lcycpO1xyXG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgZ2FtZU1hbmFnZXIubW9kaWZ5R2FtZSh0ZXN0TW9kaWZ5R2FtZSk7XHJcbiAgICBleHBlY3QocmVzcG9uc2UpLnRvRXF1YWwodGVzdE1vZGlmeUdhbWUpO1xyXG59KTtcclxuXHJcbnRlc3QoXCJEZWxldGVHYW1lXCIsIGFzeW5jICgpID0+IHtcclxuICAgIGxldCBnYW1lSUQgPSAnMTIzNDU2JztcclxuICAgIGxldCB1c2VySUQgPSAnZXJpa2NoYXVsayc7XHJcbiAgICBsZXQgdGVzdERlbGV0ZUdhbWUgPSBuZXcgZ2FtZS5HYW1lKGdhbWVJRCwgdXNlcklELCAnTGVhZ3VlIG9mIExlZ2VuZHMnLCAyMDEwLCAnTW9iYScsICdQQycsICdSaW90IEdhbWVzJyk7XHJcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBnYW1lTWFuYWdlci5kZWxldGVHYW1lKHRlc3REZWxldGVHYW1lKTtcclxuICAgIGV4cGVjdChyZXNwb25zZSkudG9FcXVhbCh0ZXN0RGVsZXRlR2FtZSk7XHJcbn0pO1xyXG5cclxudGVzdChcInNlcmlhbGl6ZUV4aXN0aW5nR2FtZURhdGFcIiwgYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IGRhdGEgPSB7XHJcbiAgICAgICAgJ2dhbWVJRCc6JzEyMzQ1NicsXHJcbiAgICAgICAgJ2dhbWVOYW1lJzonTGVhZ3VlIG9mIExlZ2VuZHMnLFxyXG4gICAgICAgICd5ZWFyUmVsZWFzZWQnOjIwMTAsXHJcbiAgICAgICAgJ2dlbnJlJzonTW9iYScsXHJcbiAgICAgICAgJ2NvbnNvbGUnOidQQycsXHJcbiAgICAgICAgJ2RldmVsb3Blcic6J1Jpb3QgR2FtZXMnXHJcbiAgICB9IFxyXG4gICAgbGV0IHVzZXJEYXRhID0ge1xyXG4gICAgICAgIHVzZXJJRDogJ2VyaWtjaGF1bGsnLFxyXG4gICAgfVxyXG4gICAgbGV0IHJlc3BvbnNlID0gY29tbW9uLnNlcmlhbGl6ZUV4aXN0aW5nR2FtZURhdGEodXNlckRhdGEsIGRhdGEpO1xyXG4gICAgbGV0IHRlc3REeW5hbW9SZXNwb25zZSA9IG5ldyBnYW1lLkdhbWUoZGF0YS5nYW1lSUQsIHVzZXJEYXRhLnVzZXJJRCwgJ0xlYWd1ZSBvZiBMZWdlbmRzJywgMjAxMCwgJ01vYmEnLCAnUEMnLCAnUmlvdCBHYW1lcycpO1xyXG4gICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKHRlc3REeW5hbW9SZXNwb25zZSk7XHJcbn0pO1xyXG5cclxudGVzdChcImdhbWVFcnJvckhhbmRsZXJcIiwgYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IHRlc3RFcnJvciA9IG5ldyBlcnJvci5HYW1lRXJyb3IoJ0dhbWUgbm90IGZvdW5kJyk7XHJcbiAgICBleHBlY3QodGVzdEVycm9yLm1lc3NhZ2UpLnRvRXF1YWwoXCJHYW1lIGVycm9yLCBkYXRhc3RvcmUgcmVzcG9uc2U6IEdhbWUgbm90IGZvdW5kXCIpO1xyXG59KTtcclxuXHJcbnRlc3QoXCJjcmVhdGVHYW1lSHR0cFJlc3BvbnNlXCIsIGFzeW5jICgpID0+IHtcclxuICAgIGxldCBnYW1lSUQgPSAnMTIzNDU2JztcclxuICAgIGxldCB1c2VySUQgPSAnZXJpa2NoYXVsayc7XHJcbiAgICBsZXQgdGVzdEdhbWUgPSBuZXcgZ2FtZS5HYW1lKGdhbWVJRCwgdXNlcklELCAnTGVhZ3VlIG9mIExlZ2VuZHMnLCAyMDEwLCAnTW9iYScsICdQQycsICdSaW90IEdhbWVzJyk7XHJcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBodHRwUmVzcG9uc2UuY3JlYXRlR2FtZUh0dHBSZXNwb25zZSh0ZXN0R2FtZSk7XHJcbiAgICBleHBlY3QocmVzcG9uc2UpLnRvRXF1YWwoaHR0cFJlc3BvbnNlLmh0dHBSZXNwb25zZSh7c3RhdHVzQ29kZTogMjAwLCBib2R5OiBKU09OLnN0cmluZ2lmeSh0ZXN0R2FtZSl9KSk7XHJcbn0pO1xyXG5cclxuLy9HYW1lIGFscmVhZHkgY3JlYXRlZFxyXG50ZXN0KFwiY3JlYXRlR2FtZUh0dHBSZXNwb25zZVwiLCBhc3luYyAoKSA9PiB7XHJcbiAgICBsZXQgZ2FtZUlEID0gJzEyMzQ1Nic7XHJcbiAgICBsZXQgdXNlcklEID0gJ2VyaWtjaGF1bGsnO1xyXG4gICAgbGV0IHRlc3RHYW1lID0gbmV3IGdhbWUuR2FtZShnYW1lSUQsIHVzZXJJRCwgJ0xlYWd1ZSBvZiBMZWdlbmRzJywgMjAxMCwgJ01vYmEnLCAnUEMnLCAnUmlvdCBHYW1lcycpO1xyXG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgaHR0cFJlc3BvbnNlLmNyZWF0ZUdhbWVIdHRwUmVzcG9uc2UodGVzdEdhbWUpO1xyXG4gICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKGh0dHBSZXNwb25zZS5odHRwUmVzcG9uc2Uoe3N0YXR1c0NvZGU6IDQwMCwgYm9keTogXCJHYW1lIEVycm9yXCJ9KSk7XHJcbn0pO1xyXG5cclxudGVzdChcImdldEdhbWVIdHRwUmVzcG9uc2VcIiwgYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IGdhbWVJRCA9ICcxMjM0NTYnO1xyXG4gICAgbGV0IHVzZXJJRCA9ICdlcmlrY2hhdWxrJztcclxuICAgIGxldCB0ZXN0R2FtZSA9IG5ldyBnYW1lLkdhbWUoZ2FtZUlELCB1c2VySUQsICdMZWFndWUgb2YgTGVnZW5kcycsIDIwMTAsICdNb2JhJywgJ1BDJywgJ1Jpb3QgR2FtZXMnKTtcclxuICAgIGxldCByZXNwb25zZSA9IGF3YWl0IGh0dHBSZXNwb25zZS5nZXRHYW1lSHR0cFJlc3BvbnNlKHRlc3RHYW1lKTtcclxuICAgIGV4cGVjdChyZXNwb25zZSkudG9FcXVhbChodHRwUmVzcG9uc2UuaHR0cFJlc3BvbnNlKHtzdGF0dXNDb2RlOiAyMDAsIGJvZHk6IEpTT04uc3RyaW5naWZ5KHRlc3RHYW1lKX0pKTtcclxufSk7XHJcblxyXG50ZXN0KFwibW9kaWZ5R2FtZUh0dHBSZXNwb25zZVwiLCBhc3luYyAoKSA9PiB7XHJcbiAgICBsZXQgZ2FtZUlEID0gJzEyMzQ1Nic7XHJcbiAgICBsZXQgdXNlcklEID0gJ2VyaWtjaGF1bGsnO1xyXG4gICAgbGV0IHRlc3RHYW1lID0gbmV3IGdhbWUuR2FtZShnYW1lSUQsIHVzZXJJRCwgJ0xlYWd1ZSBvZiBMZWdlbmRzJywgMjAxMiwgJ01vYmEnLCAnUEMnLCAnUmlvdCBHYW1lcycpO1xyXG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgaHR0cFJlc3BvbnNlLm1vZGlmeUdhbWVIdHRwUmVzcG9uc2UodGVzdEdhbWUpO1xyXG4gICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKGh0dHBSZXNwb25zZS5odHRwUmVzcG9uc2Uoe3N0YXR1c0NvZGU6IDIwMCwgYm9keTogSlNPTi5zdHJpbmdpZnkodGVzdEdhbWUpfSkpO1xyXG59KTtcclxuXHJcbi8vTW9kaWZ5IGEgZ2FtZSB0aGF0IGRvZXNuJ3QgZXhpc3RcclxudGVzdChcIm1vZGlmeUdhbWVIdHRwUmVzcG9uc2VcIiwgYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IGdhbWVJRCA9ICcyMzQ1NjcnO1xyXG4gICAgbGV0IHVzZXJJRCA9ICdlcmlrY2hhdWxrJztcclxuICAgIGxldCB0ZXN0R2FtZSA9IG5ldyBnYW1lLkdhbWUoZ2FtZUlELCB1c2VySUQsICdUaGUgV2l0bmVzcycsIDIwMTYsICdTdHJhdGVneScsICdQQycsICdWYWx2ZScpO1xyXG4gICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgaHR0cFJlc3BvbnNlLm1vZGlmeUdhbWVIdHRwUmVzcG9uc2UodGVzdEdhbWUpO1xyXG4gICAgZXhwZWN0KHJlc3BvbnNlKS50b0VxdWFsKGh0dHBSZXNwb25zZS5odHRwUmVzcG9uc2Uoe3N0YXR1c0NvZGU6IDQwMCwgYm9keTogXCJHYW1lIEVycm9yXCJ9KSk7XHJcbn0pO1xyXG5cclxudGVzdChcImRlbGV0ZUdhbWVIdHRwUmVzcG9uc2VcIiwgYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IGdhbWVJRCA9ICcxMjM0NTYnO1xyXG4gICAgbGV0IHVzZXJJRCA9ICdlcmlrY2hhdWxrJztcclxuICAgIGxldCB0ZXN0R2FtZSA9IG5ldyBnYW1lLkdhbWUoZ2FtZUlELCB1c2VySUQsICdMZWFndWUgb2YgTGVnZW5kcycsIDIwMTIsICdNb2JhJywgJ1BDJywgJ1Jpb3QgR2FtZXMnKTtcclxuICAgIGxldCByZXNwb25zZSA9IGF3YWl0IGh0dHBSZXNwb25zZS5kZWxldGVHYW1lSHR0cFJlc3BvbnNlKHRlc3RHYW1lKTtcclxuICAgIGV4cGVjdChyZXNwb25zZSkudG9FcXVhbChodHRwUmVzcG9uc2UuaHR0cFJlc3BvbnNlKHtzdGF0dXNDb2RlOiAyMDAsIGJvZHk6IEpTT04uc3RyaW5naWZ5KHRlc3RHYW1lKX0pKTtcclxufSk7XHJcblxyXG4vL0RlbGV0ZSBhIGdhbWUgdGhhdCBkb2Vzbid0IGV4aXN0XHJcbnRlc3QoXCJkZWxldGVHYW1lSHR0cFJlc3BvbnNlXCIsIGFzeW5jICgpID0+IHtcclxuICAgIGxldCBnYW1lSUQgPSAnMTIzNDU2JztcclxuICAgIGxldCB1c2VySUQgPSAnZXJpa2NoYXVsayc7XHJcbiAgICBsZXQgdGVzdEdhbWUgPSBuZXcgZ2FtZS5HYW1lKGdhbWVJRCwgdXNlcklELCAnTGVhZ3VlIG9mIExlZ2VuZHMnLCAyMDEyLCAnTW9iYScsICdQQycsICdSaW90IEdhbWVzJyk7XHJcbiAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBodHRwUmVzcG9uc2UuZGVsZXRlR2FtZUh0dHBSZXNwb25zZSh0ZXN0R2FtZSk7XHJcbiAgICBleHBlY3QocmVzcG9uc2UpLnRvRXF1YWwoaHR0cFJlc3BvbnNlLmh0dHBSZXNwb25zZSh7c3RhdHVzQ29kZTogNDAwLCBib2R5OiBcIkdhbWUgRXJyb3JcIn0pKTtcclxufSk7Il19