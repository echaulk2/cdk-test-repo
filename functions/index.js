"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Common = require("./shared/common/game");
const CommonPriceMonitor = require("./shared/common/gamePriceMonitor");
const CommonUser = require("./shared/common/user");
const CommonCollection = require("./shared/common/collection");
const HttpResponse = require("./shared/common/httpResponse");
const wishlist_1 = require("./models/wishlist");
exports.handler = async (event, context, callback) => {
    let userData = {
        userID: `U-${event.requestContext.authorizer.claims['cognito:username']}`,
        email: event.requestContext.authorizer.claims['email']
    };
    switch (event.path) {
        case ("/createUser"):
            let createUserData = CommonUser.serializeNewUserData(userData);
            callback(null, await HttpResponse.createUserHttpResponse(createUserData));
            break;
        case ("/getGame"):
            let payload = {
                gameID: event === null || event === void 0 ? void 0 : event.queryStringParameters["gameID"]
            };
            let getGameData = Common.serializeExistingGameData(userData, payload);
            callback(null, await HttpResponse.getGameHttpResponse(getGameData));
            break;
        case ("/listGames"):
            let listGameData = userData;
            callback(null, await HttpResponse.listGamesHttpResponse(listGameData));
            break;
        case ("/createGame"):
            let createGameData = Common.serializeNewGameData(userData, JSON.parse(event.body));
            callback(null, await HttpResponse.createGameHttpResponse(createGameData));
            break;
        case ("/modifyGame"):
            let modifyGameData = Common.serializeExistingGameData(userData, JSON.parse(event.body));
            callback(null, await HttpResponse.modifyGameHttpResponse(modifyGameData));
            break;
        case ("/deleteGame"):
            let deleteGameData = Common.serializeExistingGameData(userData, JSON.parse(event.body));
            callback(null, await HttpResponse.deleteGameHttpResponse(deleteGameData));
            break;
        case ("/collection/wishlist/"):
            let wishlistID = event === null || event === void 0 ? void 0 : event.queryStringParameters["collectionID"];
            let wishlist = new wishlist_1.Wishlist(userData.userID, wishlistID);
            callback(null, await HttpResponse.getWishlistHttpResponse(wishlist));
            break;
        case ("/collection/wishlist/createWishlist"):
            let createWishlistData = CommonCollection.serializeNewWishlist(userData);
            callback(null, await HttpResponse.createWishlistHttpResponse(createWishlistData));
        case ("/collection/wishlist/addGame"):
            let addGameData = Common.serializeNewGameData(userData, JSON.parse(event.body));
            callback(null, await HttpResponse.addGameToWishlistHttpResponse(addGameData));
            break;
        case ("/collection/wishlist/modifyGame"):
            let modifyWishlistData = Common.serializeExistingGameData(userData, JSON.parse(event.body));
            callback(null, await HttpResponse.modifyGameInWishlistHttpResponse(modifyWishlistData));
            break;
        case ("/collection/wishlist/removeGame"):
            let removeGameData = Common.serializeExistingGameData(userData, JSON.parse(event.body));
            callback(null, await HttpResponse.removeGameFromWishlistHttpResponse(removeGameData));
            break;
        case ("/collection/wishlist/addPriceMonitor"):
            let addPriceMonitor = CommonPriceMonitor.serializeNewGamePriceMonitorData(userData, JSON.parse(event.body));
            callback(null, await HttpResponse.addPriceMonitorToWishlistHttpResponse(addPriceMonitor));
            break;
        case ("/collection/wishlist/modifyPriceMonitor"):
            let modifyPriceMonitor = CommonPriceMonitor.serializeExistingGamePriceMonitorData(userData, JSON.parse(event.body));
            callback(null, await HttpResponse.modifyPriceMonitorWishlistHttpResponse(modifyPriceMonitor));
            break;
        case ("/collection/wishlist/deletePriceMonitor"):
            let deletePriceMonitor = CommonPriceMonitor.serializeExistingGamePriceMonitorData(userData, JSON.parse(event.body));
            callback(null, await HttpResponse.deletePriceMonitorWishlistHttpResponse(deletePriceMonitor));
            break;
        default:
            callback(null, HttpResponse.httpResponse({ statusCode: 400, body: JSON.stringify("Invalid operation.") }));
            break;
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLCtDQUErQztBQUMvQyx1RUFBdUU7QUFDdkUsbURBQW1EO0FBQ25ELCtEQUErRDtBQUMvRCw2REFBNkQ7QUFDN0QsZ0RBQTZDO0FBRTdDLE9BQU8sQ0FBQyxPQUFPLEdBQUcsS0FBSyxFQUFFLEtBQVUsRUFBRSxPQUFZLEVBQUUsUUFBYSxFQUFFLEVBQUU7SUFDbEUsSUFBSSxRQUFRLEdBQXlCO1FBQ25DLE1BQU0sRUFBRSxLQUFLLEtBQUssQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxFQUFFO1FBQ3pFLEtBQUssRUFBRSxLQUFLLENBQUMsY0FBYyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDO0tBQ3ZELENBQUM7SUFFRixRQUFRLEtBQUssQ0FBQyxJQUFJLEVBQUU7UUFDbEIsS0FBSyxDQUFDLGFBQWEsQ0FBQztZQUNsQixJQUFJLGNBQWMsR0FBRyxVQUFVLENBQUMsb0JBQW9CLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDL0QsUUFBUSxDQUFDLElBQUksRUFBRSxNQUFNLFlBQVksQ0FBQyxzQkFBc0IsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO1lBQzFFLE1BQU07UUFDUixLQUFLLENBQUMsVUFBVSxDQUFDO1lBQ2YsSUFBSSxPQUFPLEdBQTRCO2dCQUNyQyxNQUFNLEVBQUUsS0FBSyxhQUFMLEtBQUssdUJBQUwsS0FBSyxDQUFFLHFCQUFxQixDQUFDLFFBQVEsQ0FBQzthQUMvQyxDQUFDO1lBQ0YsSUFBSSxXQUFXLEdBQUcsTUFBTSxDQUFDLHlCQUF5QixDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQTtZQUNyRSxRQUFRLENBQUMsSUFBSSxFQUFFLE1BQU0sWUFBWSxDQUFDLG1CQUFtQixDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7WUFDcEUsTUFBTTtRQUNSLEtBQUksQ0FBQyxZQUFZLENBQUM7WUFDaEIsSUFBSSxZQUFZLEdBQUcsUUFBUSxDQUFDO1lBQzVCLFFBQVEsQ0FBQyxJQUFJLEVBQUUsTUFBTSxZQUFZLENBQUMscUJBQXFCLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQztZQUN2RSxNQUFNO1FBQ1IsS0FBSSxDQUFDLGFBQWEsQ0FBQztZQUNqQixJQUFJLGNBQWMsR0FBRyxNQUFNLENBQUMsb0JBQW9CLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDbkYsUUFBUSxDQUFDLElBQUksRUFBRSxNQUFNLFlBQVksQ0FBQyxzQkFBc0IsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO1lBQzFFLE1BQU07UUFDUixLQUFJLENBQUMsYUFBYSxDQUFDO1lBQ2pCLElBQUksY0FBYyxHQUFHLE1BQU0sQ0FBQyx5QkFBeUIsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUN4RixRQUFRLENBQUMsSUFBSSxFQUFFLE1BQU0sWUFBWSxDQUFDLHNCQUFzQixDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUM7WUFDMUUsTUFBTTtRQUNSLEtBQUssQ0FBQyxhQUFhLENBQUM7WUFDbEIsSUFBSSxjQUFjLEdBQUcsTUFBTSxDQUFDLHlCQUF5QixDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQ3hGLFFBQVEsQ0FBQyxJQUFJLEVBQUUsTUFBTSxZQUFZLENBQUMsc0JBQXNCLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQztZQUMxRSxNQUFNO1FBQ1IsS0FBSyxDQUFDLHVCQUF1QixDQUFDO1lBQzVCLElBQUksVUFBVSxHQUFHLEtBQUssYUFBTCxLQUFLLHVCQUFMLEtBQUssQ0FBRSxxQkFBcUIsQ0FBQyxjQUFjLENBQUMsQ0FBQTtZQUM3RCxJQUFJLFFBQVEsR0FBRyxJQUFJLG1CQUFRLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxVQUFVLENBQUMsQ0FBQztZQUN6RCxRQUFRLENBQUMsSUFBSSxFQUFFLE1BQU0sWUFBWSxDQUFDLHVCQUF1QixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7WUFDckUsTUFBTTtRQUNSLEtBQUssQ0FBQyxxQ0FBcUMsQ0FBQztZQUMxQyxJQUFJLGtCQUFrQixHQUFHLGdCQUFnQixDQUFDLG9CQUFvQixDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQ3pFLFFBQVEsQ0FBQyxJQUFJLEVBQUUsTUFBTSxZQUFZLENBQUMsMEJBQTBCLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDO1FBQ3BGLEtBQUssQ0FBQyw4QkFBOEIsQ0FBQztZQUNuQyxJQUFJLFdBQVcsR0FBRyxNQUFNLENBQUMsb0JBQW9CLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDaEYsUUFBUSxDQUFDLElBQUksRUFBRSxNQUFNLFlBQVksQ0FBQyw2QkFBNkIsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1lBQzlFLE1BQU07UUFDUixLQUFLLENBQUMsaUNBQWlDLENBQUM7WUFDdEMsSUFBSSxrQkFBa0IsR0FBRyxNQUFNLENBQUMseUJBQXlCLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDNUYsUUFBUSxDQUFDLElBQUksRUFBRSxNQUFNLFlBQVksQ0FBQyxnQ0FBZ0MsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUM7WUFDeEYsTUFBTTtRQUNSLEtBQUssQ0FBQyxpQ0FBaUMsQ0FBQztZQUN0QyxJQUFJLGNBQWMsR0FBRyxNQUFNLENBQUMseUJBQXlCLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDeEYsUUFBUSxDQUFDLElBQUksRUFBRSxNQUFNLFlBQVksQ0FBQyxrQ0FBa0MsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO1lBQ3RGLE1BQU07UUFDUixLQUFLLENBQUMsc0NBQXNDLENBQUM7WUFDM0MsSUFBSSxlQUFlLEdBQUcsa0JBQWtCLENBQUMsZ0NBQWdDLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDNUcsUUFBUSxDQUFDLElBQUksRUFBRSxNQUFNLFlBQVksQ0FBQyxxQ0FBcUMsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDO1lBQzFGLE1BQU07UUFDUixLQUFLLENBQUMseUNBQXlDLENBQUM7WUFDOUMsSUFBSSxrQkFBa0IsR0FBRyxrQkFBa0IsQ0FBQyxxQ0FBcUMsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUNwSCxRQUFRLENBQUMsSUFBSSxFQUFFLE1BQU0sWUFBWSxDQUFDLHNDQUFzQyxDQUFDLGtCQUFrQixDQUFDLENBQUMsQ0FBQztZQUM5RixNQUFNO1FBQ1IsS0FBSyxDQUFDLHlDQUF5QyxDQUFDO1lBQzlDLElBQUksa0JBQWtCLEdBQUcsa0JBQWtCLENBQUMscUNBQXFDLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDcEgsUUFBUSxDQUFDLElBQUksRUFBRSxNQUFNLFlBQVksQ0FBQyxzQ0FBc0MsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUM7WUFDOUYsTUFBTTtRQUNSO1lBQ0UsUUFBUSxDQUFDLElBQUksRUFBRSxZQUFZLENBQUMsWUFBWSxDQUFDLEVBQUMsVUFBVSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3pHLE1BQU07S0FDUDtBQUNMLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEludGVyZmFjZXMgZnJvbSBcIi4vc2hhcmVkL2ludGVyZmFjZXMvaW50ZXJmYWNlc1wiXHJcbmltcG9ydCAqIGFzIENvbW1vbiBmcm9tIFwiLi9zaGFyZWQvY29tbW9uL2dhbWVcIjtcclxuaW1wb3J0ICogYXMgQ29tbW9uUHJpY2VNb25pdG9yIGZyb20gXCIuL3NoYXJlZC9jb21tb24vZ2FtZVByaWNlTW9uaXRvclwiO1xyXG5pbXBvcnQgKiBhcyBDb21tb25Vc2VyIGZyb20gXCIuL3NoYXJlZC9jb21tb24vdXNlclwiO1xyXG5pbXBvcnQgKiBhcyBDb21tb25Db2xsZWN0aW9uIGZyb20gXCIuL3NoYXJlZC9jb21tb24vY29sbGVjdGlvblwiO1xyXG5pbXBvcnQgKiBhcyBIdHRwUmVzcG9uc2UgZnJvbSBcIi4vc2hhcmVkL2NvbW1vbi9odHRwUmVzcG9uc2VcIjtcclxuaW1wb3J0IHsgV2lzaGxpc3QgfSBmcm9tIFwiLi9tb2RlbHMvd2lzaGxpc3RcIjtcclxuXHJcbmV4cG9ydHMuaGFuZGxlciA9IGFzeW5jIChldmVudDogYW55LCBjb250ZXh0OiBhbnksIGNhbGxiYWNrOiBhbnkpID0+IHtcclxuICBsZXQgdXNlckRhdGE6IEludGVyZmFjZXMuSVVzZXJEYXRhID0ge1xyXG4gICAgdXNlcklEOiBgVS0ke2V2ZW50LnJlcXVlc3RDb250ZXh0LmF1dGhvcml6ZXIuY2xhaW1zWydjb2duaXRvOnVzZXJuYW1lJ119YCxcclxuICAgIGVtYWlsOiBldmVudC5yZXF1ZXN0Q29udGV4dC5hdXRob3JpemVyLmNsYWltc1snZW1haWwnXVxyXG4gIH07XHJcblxyXG4gIHN3aXRjaCAoZXZlbnQucGF0aCkge1xyXG4gICAgY2FzZSAoXCIvY3JlYXRlVXNlclwiKTpcclxuICAgICAgbGV0IGNyZWF0ZVVzZXJEYXRhID0gQ29tbW9uVXNlci5zZXJpYWxpemVOZXdVc2VyRGF0YSh1c2VyRGF0YSk7XHJcbiAgICAgIGNhbGxiYWNrKG51bGwsIGF3YWl0IEh0dHBSZXNwb25zZS5jcmVhdGVVc2VySHR0cFJlc3BvbnNlKGNyZWF0ZVVzZXJEYXRhKSk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAoXCIvZ2V0R2FtZVwiKTpcclxuICAgICAgbGV0IHBheWxvYWQ6IEludGVyZmFjZXMuSVBheWxvYWREYXRhID0geyBcclxuICAgICAgICBnYW1lSUQ6IGV2ZW50Py5xdWVyeVN0cmluZ1BhcmFtZXRlcnNbXCJnYW1lSURcIl1cclxuICAgICAgfTtcclxuICAgICAgbGV0IGdldEdhbWVEYXRhID0gQ29tbW9uLnNlcmlhbGl6ZUV4aXN0aW5nR2FtZURhdGEodXNlckRhdGEsIHBheWxvYWQpXHJcbiAgICAgIGNhbGxiYWNrKG51bGwsIGF3YWl0IEh0dHBSZXNwb25zZS5nZXRHYW1lSHR0cFJlc3BvbnNlKGdldEdhbWVEYXRhKSk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZShcIi9saXN0R2FtZXNcIik6XHJcbiAgICAgIGxldCBsaXN0R2FtZURhdGEgPSB1c2VyRGF0YTtcclxuICAgICAgY2FsbGJhY2sobnVsbCwgYXdhaXQgSHR0cFJlc3BvbnNlLmxpc3RHYW1lc0h0dHBSZXNwb25zZShsaXN0R2FtZURhdGEpKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlKFwiL2NyZWF0ZUdhbWVcIik6XHJcbiAgICAgIGxldCBjcmVhdGVHYW1lRGF0YSA9IENvbW1vbi5zZXJpYWxpemVOZXdHYW1lRGF0YSh1c2VyRGF0YSwgSlNPTi5wYXJzZShldmVudC5ib2R5KSk7XHJcbiAgICAgIGNhbGxiYWNrKG51bGwsIGF3YWl0IEh0dHBSZXNwb25zZS5jcmVhdGVHYW1lSHR0cFJlc3BvbnNlKGNyZWF0ZUdhbWVEYXRhKSk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZShcIi9tb2RpZnlHYW1lXCIpOlxyXG4gICAgICBsZXQgbW9kaWZ5R2FtZURhdGEgPSBDb21tb24uc2VyaWFsaXplRXhpc3RpbmdHYW1lRGF0YSh1c2VyRGF0YSwgSlNPTi5wYXJzZShldmVudC5ib2R5KSk7XHJcbiAgICAgIGNhbGxiYWNrKG51bGwsIGF3YWl0IEh0dHBSZXNwb25zZS5tb2RpZnlHYW1lSHR0cFJlc3BvbnNlKG1vZGlmeUdhbWVEYXRhKSk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAoXCIvZGVsZXRlR2FtZVwiKTpcclxuICAgICAgbGV0IGRlbGV0ZUdhbWVEYXRhID0gQ29tbW9uLnNlcmlhbGl6ZUV4aXN0aW5nR2FtZURhdGEodXNlckRhdGEsIEpTT04ucGFyc2UoZXZlbnQuYm9keSkpO1xyXG4gICAgICBjYWxsYmFjayhudWxsLCBhd2FpdCBIdHRwUmVzcG9uc2UuZGVsZXRlR2FtZUh0dHBSZXNwb25zZShkZWxldGVHYW1lRGF0YSkpO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgKFwiL2NvbGxlY3Rpb24vd2lzaGxpc3QvXCIpOlxyXG4gICAgICBsZXQgd2lzaGxpc3RJRCA9IGV2ZW50Py5xdWVyeVN0cmluZ1BhcmFtZXRlcnNbXCJjb2xsZWN0aW9uSURcIl1cclxuICAgICAgbGV0IHdpc2hsaXN0ID0gbmV3IFdpc2hsaXN0KHVzZXJEYXRhLnVzZXJJRCwgd2lzaGxpc3RJRCk7XHJcbiAgICAgIGNhbGxiYWNrKG51bGwsIGF3YWl0IEh0dHBSZXNwb25zZS5nZXRXaXNobGlzdEh0dHBSZXNwb25zZSh3aXNobGlzdCkpO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgKFwiL2NvbGxlY3Rpb24vd2lzaGxpc3QvY3JlYXRlV2lzaGxpc3RcIik6XHJcbiAgICAgIGxldCBjcmVhdGVXaXNobGlzdERhdGEgPSBDb21tb25Db2xsZWN0aW9uLnNlcmlhbGl6ZU5ld1dpc2hsaXN0KHVzZXJEYXRhKTtcclxuICAgICAgY2FsbGJhY2sobnVsbCwgYXdhaXQgSHR0cFJlc3BvbnNlLmNyZWF0ZVdpc2hsaXN0SHR0cFJlc3BvbnNlKGNyZWF0ZVdpc2hsaXN0RGF0YSkpOyAgICAgIFxyXG4gICAgY2FzZSAoXCIvY29sbGVjdGlvbi93aXNobGlzdC9hZGRHYW1lXCIpOlxyXG4gICAgICBsZXQgYWRkR2FtZURhdGEgPSBDb21tb24uc2VyaWFsaXplTmV3R2FtZURhdGEodXNlckRhdGEsIEpTT04ucGFyc2UoZXZlbnQuYm9keSkpO1xyXG4gICAgICBjYWxsYmFjayhudWxsLCBhd2FpdCBIdHRwUmVzcG9uc2UuYWRkR2FtZVRvV2lzaGxpc3RIdHRwUmVzcG9uc2UoYWRkR2FtZURhdGEpKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlIChcIi9jb2xsZWN0aW9uL3dpc2hsaXN0L21vZGlmeUdhbWVcIik6XHJcbiAgICAgIGxldCBtb2RpZnlXaXNobGlzdERhdGEgPSBDb21tb24uc2VyaWFsaXplRXhpc3RpbmdHYW1lRGF0YSh1c2VyRGF0YSwgSlNPTi5wYXJzZShldmVudC5ib2R5KSk7XHJcbiAgICAgIGNhbGxiYWNrKG51bGwsIGF3YWl0IEh0dHBSZXNwb25zZS5tb2RpZnlHYW1lSW5XaXNobGlzdEh0dHBSZXNwb25zZShtb2RpZnlXaXNobGlzdERhdGEpKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlIChcIi9jb2xsZWN0aW9uL3dpc2hsaXN0L3JlbW92ZUdhbWVcIik6XHJcbiAgICAgIGxldCByZW1vdmVHYW1lRGF0YSA9IENvbW1vbi5zZXJpYWxpemVFeGlzdGluZ0dhbWVEYXRhKHVzZXJEYXRhLCBKU09OLnBhcnNlKGV2ZW50LmJvZHkpKTtcclxuICAgICAgY2FsbGJhY2sobnVsbCwgYXdhaXQgSHR0cFJlc3BvbnNlLnJlbW92ZUdhbWVGcm9tV2lzaGxpc3RIdHRwUmVzcG9uc2UocmVtb3ZlR2FtZURhdGEpKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlIChcIi9jb2xsZWN0aW9uL3dpc2hsaXN0L2FkZFByaWNlTW9uaXRvclwiKTpcclxuICAgICAgbGV0IGFkZFByaWNlTW9uaXRvciA9IENvbW1vblByaWNlTW9uaXRvci5zZXJpYWxpemVOZXdHYW1lUHJpY2VNb25pdG9yRGF0YSh1c2VyRGF0YSwgSlNPTi5wYXJzZShldmVudC5ib2R5KSk7XHJcbiAgICAgIGNhbGxiYWNrKG51bGwsIGF3YWl0IEh0dHBSZXNwb25zZS5hZGRQcmljZU1vbml0b3JUb1dpc2hsaXN0SHR0cFJlc3BvbnNlKGFkZFByaWNlTW9uaXRvcikpO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgKFwiL2NvbGxlY3Rpb24vd2lzaGxpc3QvbW9kaWZ5UHJpY2VNb25pdG9yXCIpOlxyXG4gICAgICBsZXQgbW9kaWZ5UHJpY2VNb25pdG9yID0gQ29tbW9uUHJpY2VNb25pdG9yLnNlcmlhbGl6ZUV4aXN0aW5nR2FtZVByaWNlTW9uaXRvckRhdGEodXNlckRhdGEsIEpTT04ucGFyc2UoZXZlbnQuYm9keSkpO1xyXG4gICAgICBjYWxsYmFjayhudWxsLCBhd2FpdCBIdHRwUmVzcG9uc2UubW9kaWZ5UHJpY2VNb25pdG9yV2lzaGxpc3RIdHRwUmVzcG9uc2UobW9kaWZ5UHJpY2VNb25pdG9yKSk7XHJcbiAgICAgIGJyZWFrOyAgICAgIFxyXG4gICAgY2FzZSAoXCIvY29sbGVjdGlvbi93aXNobGlzdC9kZWxldGVQcmljZU1vbml0b3JcIik6XHJcbiAgICAgIGxldCBkZWxldGVQcmljZU1vbml0b3IgPSBDb21tb25QcmljZU1vbml0b3Iuc2VyaWFsaXplRXhpc3RpbmdHYW1lUHJpY2VNb25pdG9yRGF0YSh1c2VyRGF0YSwgSlNPTi5wYXJzZShldmVudC5ib2R5KSk7XHJcbiAgICAgIGNhbGxiYWNrKG51bGwsIGF3YWl0IEh0dHBSZXNwb25zZS5kZWxldGVQcmljZU1vbml0b3JXaXNobGlzdEh0dHBSZXNwb25zZShkZWxldGVQcmljZU1vbml0b3IpKTtcclxuICAgICAgYnJlYWs7ICAgICAgICBcclxuICAgIGRlZmF1bHQ6XHJcbiAgICAgIGNhbGxiYWNrKG51bGwsIEh0dHBSZXNwb25zZS5odHRwUmVzcG9uc2Uoe3N0YXR1c0NvZGU6IDQwMCwgYm9keTogSlNPTi5zdHJpbmdpZnkoXCJJbnZhbGlkIG9wZXJhdGlvbi5cIil9KSk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG59ICBcclxuIl19